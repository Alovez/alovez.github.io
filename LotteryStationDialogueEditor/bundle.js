"use strict";var BaklavaJS=(()=>{var gs=Object.defineProperty;var Dl=Object.getOwnPropertyDescriptor;var Il=Object.getOwnPropertyNames;var Sl=Object.prototype.hasOwnProperty;var Sn=(e,t)=>{for(var n in t)gs(e,n,{get:t[n],enumerable:!0})},Vl=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Il(t))!Sl.call(e,s)&&s!==n&&gs(e,s,{get:()=>t[s],enumerable:!(o=Dl(t,s))||o.enumerable});return e};var $l=e=>Vl(gs({},"__esModule",{value:!0}),e);var Kh={};Sn(Kh,{Core:()=>Es,Engine:()=>Os,InterfaceTypes:()=>ks,RendererVue:()=>ei,createBaklava:()=>Bh});var Es={};Sn(Es,{AbstractNode:()=>an,Connection:()=>rn,DummyConnection:()=>jt,DynamicNode:()=>mo,Editor:()=>Mn,GRAPH_NODE_TYPE_PREFIX:()=>Lt,Graph:()=>qe,GraphTemplate:()=>Ht,Node:()=>mt,NodeInterface:()=>Oe,createGraphNodeType:()=>bs,defineDynamicNode:()=>Fl,defineNode:()=>Rl,getGraphNodeTypeString:()=>it});var po,Ml=new Uint8Array(16);function ys(){if(!po&&(po=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!po))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return po(Ml)}var Ee=[];for(let e=0;e<256;++e)Ee.push((e+256).toString(16).slice(1));function ii(e,t=0){return Ee[e[t+0]]+Ee[e[t+1]]+Ee[e[t+2]]+Ee[e[t+3]]+"-"+Ee[e[t+4]]+Ee[e[t+5]]+"-"+Ee[e[t+6]]+Ee[e[t+7]]+"-"+Ee[e[t+8]]+Ee[e[t+9]]+"-"+Ee[e[t+10]]+Ee[e[t+11]]+Ee[e[t+12]]+Ee[e[t+13]]+Ee[e[t+14]]+Ee[e[t+15]]}var Pl=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_s={randomUUID:Pl};function Al(e,t,n){if(_s.randomUUID&&!t&&!e)return _s.randomUUID();e=e||{};let o=e.random||(e.rng||ys)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){n=n||0;for(let s=0;s<16;++s)t[n+s]=o[s];return t}return ii(o)}var Se=Al;var We=class{constructor(){this.listenerMap=new Map,this._listeners=[],this.proxyMap=new Map,this.proxies=[]}get listeners(){return this._listeners.concat(this.proxies.flatMap(t=>t()))}subscribe(t,n){this.listenerMap.has(t)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different handlers for the same event/hook.`),this.unsubscribe(t)),this.listenerMap.set(t,n),this._listeners.push(n)}unsubscribe(t){if(this.listenerMap.has(t)){let n=this.listenerMap.get(t);this.listenerMap.delete(t);let o=this._listeners.indexOf(n);o>=0&&this._listeners.splice(o,1)}}registerProxy(t,n){this.proxyMap.has(t)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different proxies for the same event/hook.`),this.unregisterProxy(t)),this.proxyMap.set(t,n),this.proxies.push(n)}unregisterProxy(t){if(!this.proxyMap.has(t))return;let n=this.proxyMap.get(t);this.proxyMap.delete(t);let o=this.proxies.indexOf(n);o>=0&&this.proxies.splice(o,1)}};var Z=class extends We{constructor(t){super(),this.entity=t}emit(t){this.listeners.forEach(n=>n(t,this.entity))}},fe=class extends We{constructor(t){super(),this.entity=t}emit(t){let n=!1,o=()=>[n=!0];for(let s of Array.from(this.listeners.values()))if(s(t,o,this.entity),n)return{prevented:!0};return{prevented:!1}}};var Vn=class extends We{execute(t,n){let o=t;for(let s of this.listeners)o=s(o,n);return o}},me=class extends Vn{constructor(t){super(),this.entity=t}execute(t){return super.execute(t,this.entity)}},ho=class extends We{constructor(t){super(),this.entity=t}execute(t){let n=[];for(let o of this.listeners)n.push(o(t,this.entity));return n}};function ze(){let e=Symbol(),t=new Map,n=new Set,o=(c,l)=>{l instanceof We&&l.registerProxy(e,()=>{var u,d;return(d=(u=t.get(c))===null||u===void 0?void 0:u.listeners)!==null&&d!==void 0?d:[]})},s=c=>{let l=new We;t.set(c,l),n.forEach(u=>o(c,u[c]))},r=c=>{n.add(c);for(let l of t.keys())o(l,c[l])},i=c=>{for(let l of t.keys())c[l]instanceof We&&c[l].unregisterProxy(e);n.delete(c)},a=()=>{n.forEach(c=>i(c)),t.clear()};return new Proxy({},{get(c,l){return l==="addTarget"?r:l==="removeTarget"?i:l==="destroy"?a:typeof l!="string"||l.startsWith("_")?c[l]:(t.has(l)||s(l),t.get(l))}})}var rn=class{constructor(t,n){if(this.destructed=!1,this.events={destruct:new Z(this)},!t||!n)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=Se(),this.from=t,this.to=n,this.from.connectionCount++,this.to.connectionCount++}destruct(){this.events.destruct.emit(),this.from.connectionCount--,this.to.connectionCount--,this.destructed=!0}},jt=class{constructor(t,n){if(!t||!n)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=Se(),this.from=t,this.to=n}};function $n(e,t){return Object.fromEntries(Object.entries(e).map(([n,o])=>[n,t(o)]))}var an=class{constructor(){this._title="",this.id=Se(),this.events={loaded:new Z(this),beforeAddInput:new fe(this),addInput:new Z(this),beforeRemoveInput:new fe(this),removeInput:new Z(this),beforeAddOutput:new fe(this),addOutput:new Z(this),beforeRemoveOutput:new fe(this),removeOutput:new Z(this),beforeTitleChanged:new fe(this),titleChanged:new Z(this),update:new Z(this)},this.hooks={beforeLoad:new me(this),afterSave:new me(this)}}get graph(){return this.graphInstance}get title(){return this._title}set title(t){this.events.beforeTitleChanged.emit(t).prevented||(this._title=t,this.events.titleChanged.emit(t))}addInput(t,n){return this.addInterface("input",t,n)}addOutput(t,n){return this.addInterface("output",t,n)}removeInput(t){return this.removeInterface("input",t)}removeOutput(t){return this.removeInterface("output",t)}registerGraph(t){this.graphInstance=t}load(t){this.hooks.beforeLoad.execute(t),this.id=t.id,this._title=t.title,Object.entries(t.inputs).forEach(([n,o])=>{this.inputs[n]&&(this.inputs[n].load(o),this.inputs[n].nodeId=this.id)}),Object.entries(t.outputs).forEach(([n,o])=>{this.outputs[n]&&(this.outputs[n].load(o),this.outputs[n].nodeId=this.id)}),this.events.loaded.emit(this)}save(){let t=$n(this.inputs,s=>s.save()),n=$n(this.outputs,s=>s.save()),o={type:this.type,id:this.id,title:this.title,inputs:t,outputs:n};return this.hooks.afterSave.execute(o)}onPlaced(){}onDestroy(){}initializeIo(){Object.entries(this.inputs).forEach(([t,n])=>this.initializeIntf("input",t,n)),Object.entries(this.outputs).forEach(([t,n])=>this.initializeIntf("output",t,n))}initializeIntf(t,n,o){o.isInput=t==="input",o.nodeId=this.id,o.events.setValue.subscribe(this,()=>this.events.update.emit({type:t,name:n,intf:o}))}addInterface(t,n,o){let s=t==="input"?this.events.beforeAddInput:this.events.beforeAddOutput,r=t==="input"?this.events.addInput:this.events.addOutput,i=t==="input"?this.inputs:this.outputs;return s.emit(o).prevented?!1:(i[n]=o,this.initializeIntf(t,n,o),r.emit(o),!0)}removeInterface(t,n){let o=t==="input"?this.events.beforeRemoveInput:this.events.beforeRemoveOutput,s=t==="input"?this.events.removeInput:this.events.removeOutput,r=t==="input"?this.inputs[n]:this.outputs[n];if(!r||o.emit(r).prevented)return!1;if(r.connectionCount>0)if(this.graphInstance)this.graphInstance.connections.filter(a=>a.from===r||a.to===r).forEach(a=>{this.graphInstance.removeConnection(a)});else throw new Error("Interface is connected, but no graph instance is specified. Unable to delete interface");return r.events.setValue.unsubscribe(this),t==="input"?delete this.inputs[n]:delete this.outputs[n],s.emit(r),!0}},mt=class extends an{load(t){super.load(t)}save(){return super.save()}};function Rl(e){return class extends mt{constructor(){var t,n;super(),this.type=e.type,this.inputs={},this.outputs={},this.calculate=e.calculate?(o,s)=>e.calculate.call(this,o,s):void 0,this._title=(t=e.title)!==null&&t!==void 0?t:e.type,this.executeFactory("input",e.inputs),this.executeFactory("output",e.outputs),(n=e.onCreate)===null||n===void 0||n.call(this)}onPlaced(){var t;(t=e.onPlaced)===null||t===void 0||t.call(this)}onDestroy(){var t;(t=e.onDestroy)===null||t===void 0||t.call(this)}executeFactory(t,n){Object.keys(n||{}).forEach(o=>{let s=n[o]();t==="input"?this.addInput(o,s):this.addOutput(o,s)})}}}var mo=class extends mt{};function Fl(e){return class extends mo{constructor(){var t,n,o,s;super(),this.type=e.type,this.inputs={},this.outputs={},this.preventUpdate=!1,this.staticInputKeys=Object.keys((t=e.inputs)!==null&&t!==void 0?t:{}),this.staticOutputKeys=Object.keys((n=e.outputs)!==null&&n!==void 0?n:{}),this._title=(o=e.title)!==null&&o!==void 0?o:e.type,this.executeFactory("input",e.inputs),this.executeFactory("output",e.outputs),e.calculate&&(this.calculate=(r,i)=>{var a;return(a=e.calculate)===null||a===void 0?void 0:a.call(this,r,i)}),(s=e.onCreate)===null||s===void 0||s.call(this)}onPlaced(){var t;this.events.update.subscribe(this,n=>{n&&(n.type==="input"&&this.staticInputKeys.includes(n.name)||n.type==="output"&&this.staticOutputKeys.includes(n.name))&&this.onUpdate()}),this.onUpdate(),(t=e.onPlaced)===null||t===void 0||t.call(this)}onDestroy(){var t;(t=e.onDestroy)===null||t===void 0||t.call(this)}load(t){this.preventUpdate=!0,this.hooks.beforeLoad.execute(t),this.id=t.id,this.title=t.title;for(let n of this.staticInputKeys)this.inputs[n].load(t.inputs[n]),this.inputs[n].nodeId=this.id;for(let n of this.staticOutputKeys)this.outputs[n].load(t.outputs[n]),this.outputs[n].nodeId=this.id;this.preventUpdate=!1,this.onUpdate(),this.preventUpdate=!0;for(let n of Object.keys(t.inputs))this.staticInputKeys.includes(n)||(this.inputs[n].load(t.inputs[n]),this.inputs[n].nodeId=this.id);for(let n of Object.keys(t.outputs))this.staticOutputKeys.includes(n)||(this.outputs[n].load(t.outputs[n]),this.outputs[n].nodeId=this.id);this.preventUpdate=!1,this.events.loaded.emit(this)}onUpdate(){var t,n,o,s;if(this.preventUpdate)return;this.graph&&this.graph.activeTransactions++;let r=this.getStaticValues(this.staticInputKeys,this.inputs),i=this.getStaticValues(this.staticOutputKeys,this.outputs),a=e.onUpdate.call(this,r,i);this.updateInterfaces("input",(t=a.inputs)!==null&&t!==void 0?t:{},(n=a.forceUpdateInputs)!==null&&n!==void 0?n:[]),this.updateInterfaces("output",(o=a.outputs)!==null&&o!==void 0?o:{},(s=a.forceUpdateOutputs)!==null&&s!==void 0?s:[]),this.graph&&this.graph.activeTransactions--}getStaticValues(t,n){let o={};for(let s of t)o[s]=n[s].value;return o}updateInterfaces(t,n,o){let s=t==="input"?this.staticInputKeys:this.staticOutputKeys,r=t==="input"?this.inputs:this.outputs;for(let i of Object.keys(r))s.includes(i)||n[i]&&!o.includes(i)||(t==="input"?this.removeInput(i):this.removeOutput(i));for(let i of Object.keys(n)){if(r[i])continue;let a=n[i]();t==="input"?this.addInput(i,a):this.addOutput(i,a)}}executeFactory(t,n){Object.keys(n||{}).forEach(o=>{let s=n[o]();t==="input"?this.addInput(o,s):this.addOutput(o,s)})}}}var qe=class{get nodes(){return this._nodes}get connections(){return this._connections}get loading(){return this._loading}get destroying(){return this._destroying}constructor(t,n){this.id=Se(),this.inputs=[],this.outputs=[],this.activeTransactions=0,this._nodes=[],this._connections=[],this._loading=!1,this._destroying=!1,this.events={beforeAddNode:new fe(this),addNode:new Z(this),beforeRemoveNode:new fe(this),removeNode:new Z(this),beforeAddConnection:new fe(this),addConnection:new Z(this),checkConnection:new fe(this),beforeRemoveConnection:new fe(this),removeConnection:new Z(this)},this.hooks={save:new me(this),load:new me(this),checkConnection:new ho(this)},this.nodeEvents=ze(),this.nodeHooks=ze(),this.connectionEvents=ze(),this.editor=t,this.template=n,t.registerGraph(this)}addNode(t){if(!this.events.beforeAddNode.emit(t).prevented)return this.nodeEvents.addTarget(t.events),this.nodeHooks.addTarget(t.hooks),t.registerGraph(this),this._nodes.push(t),t=this.nodes.find(n=>n.id===t.id),t.onPlaced(),this.events.addNode.emit(t),t}removeNode(t){if(this.nodes.includes(t)){if(this.events.beforeRemoveNode.emit(t).prevented)return;let n=[...Object.values(t.inputs),...Object.values(t.outputs)];this.connections.filter(o=>n.includes(o.from)||n.includes(o.to)).forEach(o=>this.removeConnection(o)),this._nodes.splice(this.nodes.indexOf(t),1),this.events.removeNode.emit(t),t.onDestroy(),this.nodeEvents.removeTarget(t.events),this.nodeHooks.removeTarget(t.hooks)}}addConnection(t,n){let o=this.checkConnection(t,n);if(!o.connectionAllowed||this.events.beforeAddConnection.emit({from:t,to:n}).prevented)return;for(let r of o.connectionsInDanger){let i=this.connections.find(a=>a.id===r.id);i&&this.removeConnection(i)}let s=new rn(o.dummyConnection.from,o.dummyConnection.to);return this.internalAddConnection(s),s}removeConnection(t){if(this.connections.includes(t)){if(this.events.beforeRemoveConnection.emit(t).prevented)return;t.destruct(),this._connections.splice(this.connections.indexOf(t),1),this.events.removeConnection.emit(t),this.connectionEvents.removeTarget(t.events)}}checkConnection(t,n){if(!t||!n)return{connectionAllowed:!1};let o=this.findNodeById(t.nodeId),s=this.findNodeById(n.nodeId);if(o&&s&&o===s)return{connectionAllowed:!1};if(t.isInput&&!n.isInput){let a=t;t=n,n=a}if(t.isInput||!n.isInput)return{connectionAllowed:!1};if(this.connections.some(a=>a.from===t&&a.to===n))return{connectionAllowed:!1};if(this.events.checkConnection.emit({from:t,to:n}).prevented)return{connectionAllowed:!1};let r=this.hooks.checkConnection.execute({from:t,to:n});if(r.some(a=>!a.connectionAllowed))return{connectionAllowed:!1};let i=Array.from(new Set(r.flatMap(a=>a.connectionsInDanger)));return{connectionAllowed:!0,dummyConnection:new jt(t,n),connectionsInDanger:i}}findNodeInterface(t){for(let n of this.nodes){for(let o in n.inputs){let s=n.inputs[o];if(s.id===t)return s}for(let o in n.outputs){let s=n.outputs[o];if(s.id===t)return s}}}findNodeById(t){return this.nodes.find(n=>n.id===t)}load(t){try{this._loading=!0;let n=[];for(let o=this.connections.length-1;o>=0;o--)this.removeConnection(this.connections[o]);for(let o=this.nodes.length-1;o>=0;o--)this.removeNode(this.nodes[o]);this.id=t.id,this.inputs=t.inputs,this.outputs=t.outputs;for(let o of t.nodes){let s=this.editor.nodeTypes.get(o.type);if(!s){n.push(`Node type ${o.type} is not registered`);continue}let r=new s.type;this.addNode(r),r.load(o)}for(let o of t.connections){let s=this.findNodeInterface(o.from),r=this.findNodeInterface(o.to);if(s)if(r){let i=new rn(s,r);i.id=o.id,this.internalAddConnection(i)}else{n.push(`Could not find interface with id ${o.to}`);continue}else{n.push(`Could not find interface with id ${o.from}`);continue}}return this.hooks.load.execute(t),n}finally{this._loading=!1}}save(){let t={id:this.id,nodes:this.nodes.map(n=>n.save()),connections:this.connections.map(n=>({id:n.id,from:n.from.id,to:n.to.id})),inputs:this.inputs,outputs:this.outputs};return this.hooks.save.execute(t)}destroy(){this._destroying=!0;for(let t of this.nodes)this.removeNode(t);this.editor.unregisterGraph(this)}internalAddConnection(t){this.connectionEvents.addTarget(t.events),this._connections.push(t),this.events.addConnection.emit(t)}};var Oe=class{set connectionCount(t){this._connectionCount=t,this.events.setConnectionCount.emit(t)}get connectionCount(){return this._connectionCount}set value(t){this.events.beforeSetValue.emit(t).prevented||(this._value=t,this.events.setValue.emit(t))}get value(){return this._value}constructor(t,n){this.id=Se(),this.nodeId="",this.port=!0,this.hidden=!1,this.events={setConnectionCount:new Z(this),beforeSetValue:new fe(this),setValue:new Z(this),updated:new Z(this)},this.hooks={load:new me(this),save:new me(this)},this._connectionCount=0,this.name=t,this._value=n}load(t){this.id=t.id,this.templateId=t.templateId,this.value=t.value,this.hooks.load.execute(t)}save(){let t={id:this.id,templateId:this.templateId,value:this.value};return this.hooks.save.execute(t)}setComponent(t){return this.component=t,this}setPort(t){return this.port=t,this}setHidden(t){return this.hidden=t,this}use(t,...n){return t(this,...n),this}};var Lt="__baklava_GraphNode-";function it(e){return Lt+e.id}function bs(e){return class extends an{constructor(){super(...arguments),this.type=it(e),this.inputs={},this.outputs={},this.template=e,this.calculate=async(n,o)=>{if(!this.subgraph)throw new Error(`GraphNode ${this.id}: calculate called without subgraph being initialized`);if(typeof o.engine=="object"&&o.engine&&typeof o.engine.runGraph=="function"){let s=new Map;for(let c of this.subgraph.nodes)Object.values(c.inputs).forEach(l=>{l.connectionCount===0&&s.set(l.id,l.value)});Object.entries(n).forEach(([c,l])=>{let u=this.subgraph.inputs.find(d=>d.id===c);s.set(u.nodeInterfaceId,l)});let r=await o.engine.runGraph(this.subgraph,s,o.globalValues),i=new Map;r.forEach((c,l)=>{let u=this.subgraph.nodes.find(d=>d.id===l);c.forEach((d,p)=>{i.set(u.outputs[p].id,d)})});let a={};return this.subgraph.outputs.forEach(c=>{a[c.id]=i.get(c.nodeInterfaceId)}),a._calculationResults=r,a}}}get title(){return this._title}set title(n){this.template.name=n}load(n){if(!this.subgraph)throw new Error("Cannot load a graph node without a graph");if(!this.template)throw new Error("Unable to load graph node without graph template");this.subgraph.load(n.graphState),super.load(n)}save(){if(!this.subgraph)throw new Error("Cannot save a graph node without a graph");return{...super.save(),graphState:this.subgraph.save()}}onPlaced(){this.template.events.updated.subscribe(this,()=>this.initialize()),this.template.events.nameChanged.subscribe(this,n=>{this._title=n}),this.initialize()}onDestroy(){var n;this.template.events.updated.unsubscribe(this),this.template.events.nameChanged.unsubscribe(this),(n=this.subgraph)===null||n===void 0||n.destroy()}initialize(){this.subgraph&&this.subgraph.destroy(),this.subgraph=this.template.createGraph(),this._title=this.template.name,this.updateInterfaces(),this.events.update.emit(null)}updateInterfaces(){if(!this.subgraph)throw new Error("Trying to update interfaces without graph instance");for(let n of this.subgraph.inputs)n.id in this.inputs?this.inputs[n.id].name=n.name:this.addInput(n.id,new Oe(n.name,void 0));for(let n of Object.keys(this.inputs))this.subgraph.inputs.some(o=>o.id===n)||this.removeInput(n);for(let n of this.subgraph.outputs)n.id in this.outputs?this.outputs[n.id].name=n.name:this.addOutput(n.id,new Oe(n.name,void 0));for(let n of Object.keys(this.outputs))this.subgraph.outputs.some(o=>o.id===n)||this.removeOutput(n);this.addOutput("_calculationResults",new Oe("_calculationResults",void 0).setHidden(!0))}}}var Ht=class e{static fromGraph(t,n){return new e(t.save(),n)}get name(){return this._name}set name(t){this._name=t,this.events.nameChanged.emit(t);let n=this.editor.nodeTypes.get(it(this));n&&(n.title=t)}constructor(t,n){this.id=Se(),this._name="Subgraph",this.events={nameChanged:new Z(this),updated:new Z(this)},this.hooks={beforeLoad:new me(this),afterSave:new me(this)},this.editor=n,t.id&&(this.id=t.id),t.name&&(this._name=t.name),this.update(t)}update(t){this.nodes=t.nodes,this.connections=t.connections,this.inputs=t.inputs,this.outputs=t.outputs,this.events.updated.emit()}save(){return{id:this.id,name:this.name,nodes:this.nodes,connections:this.connections,inputs:this.inputs,outputs:this.outputs}}createGraph(t){let n=new Map,o=d=>{let p=Se();return n.set(d,p),p},s=d=>{let p=n.get(d);if(!p)throw new Error(`Unable to create graph from template: Could not map old id ${d} to new id`);return p},r=d=>$n(d,p=>({id:o(p.id),templateId:p.id,value:p.value})),i=this.nodes.map(d=>({...d,id:o(d.id),inputs:r(d.inputs),outputs:r(d.outputs)})),a=this.connections.map(d=>({id:o(d.id),from:s(d.from),to:s(d.to)})),c=this.inputs.map(d=>({id:d.id,name:d.name,nodeInterfaceId:s(d.nodeInterfaceId)})),l=this.outputs.map(d=>({id:d.id,name:d.name,nodeInterfaceId:s(d.nodeInterfaceId)})),u={id:Se(),nodes:i,connections:a,inputs:c,outputs:l};return t||(t=new qe(this.editor)),t.load(u),t.template=this,t}};var Mn=class{constructor(){this.events={loaded:new Z(this),beforeRegisterNodeType:new fe(this),registerNodeType:new Z(this),beforeUnregisterNodeType:new fe(this),unregisterNodeType:new Z(this),beforeAddGraphTemplate:new fe(this),addGraphTemplate:new Z(this),beforeRemoveGraphTemplate:new fe(this),removeGraphTemplate:new Z(this),registerGraph:new Z(this),unregisterGraph:new Z(this)},this.hooks={save:new me(this),load:new me(this)},this.graphTemplateEvents=ze(),this.graphTemplateHooks=ze(),this.graphEvents=ze(),this.graphHooks=ze(),this.nodeEvents=ze(),this.nodeHooks=ze(),this.connectionEvents=ze(),this._graphs=new Set,this._nodeTypes=new Map,this._graph=new qe(this),this._graphTemplates=[],this._loading=!1}get nodeTypes(){return this._nodeTypes}get graph(){return this._graph}get graphTemplates(){return this._graphTemplates}get graphs(){return this._graphs}get loading(){return this._loading}registerNodeType(t,n){var o,s;if(this.events.beforeRegisterNodeType.emit({type:t,options:n}).prevented)return;let r=new t;this._nodeTypes.set(r.type,{type:t,category:(o=n?.category)!==null&&o!==void 0?o:"default",title:(s=n?.title)!==null&&s!==void 0?s:r.title}),this.events.registerNodeType.emit({type:t,options:n})}unregisterNodeType(t){let n=typeof t=="string"?t:new t().type;if(this.nodeTypes.has(n)){if(this.events.beforeUnregisterNodeType.emit(n).prevented)return;this._nodeTypes.delete(n),this.events.unregisterNodeType.emit(n)}}addGraphTemplate(t){if(this.events.beforeAddGraphTemplate.emit(t).prevented)return;this._graphTemplates.push(t),this.graphTemplateEvents.addTarget(t.events),this.graphTemplateHooks.addTarget(t.hooks);let n=bs(t);this.registerNodeType(n,{category:"Subgraphs",title:t.name}),this.events.addGraphTemplate.emit(t)}removeGraphTemplate(t){if(this.graphTemplates.includes(t)){if(this.events.beforeRemoveGraphTemplate.emit(t).prevented)return;let n=it(t);for(let o of[this.graph,...this.graphs.values()]){let s=o.nodes.filter(r=>r.type===n);for(let r of s)o.removeNode(r)}this.unregisterNodeType(n),this._graphTemplates.splice(this._graphTemplates.indexOf(t),1),this.graphTemplateEvents.removeTarget(t.events),this.graphTemplateHooks.removeTarget(t.hooks),this.events.removeGraphTemplate.emit(t)}}registerGraph(t){this.graphEvents.addTarget(t.events),this.graphHooks.addTarget(t.hooks),this.nodeEvents.addTarget(t.nodeEvents),this.nodeHooks.addTarget(t.nodeHooks),this.connectionEvents.addTarget(t.connectionEvents),this.events.registerGraph.emit(t),this._graphs.add(t)}unregisterGraph(t){this.graphEvents.removeTarget(t.events),this.graphHooks.removeTarget(t.hooks),this.nodeEvents.removeTarget(t.nodeEvents),this.nodeHooks.removeTarget(t.nodeHooks),this.connectionEvents.removeTarget(t.connectionEvents),this.events.unregisterGraph.emit(t),this._graphs.delete(t)}load(t){try{this._loading=!0,t=this.hooks.load.execute(t),t.graphTemplates.forEach(o=>{let s=new Ht(o,this);this.addGraphTemplate(s)});let n=this._graph.load(t.graph);return this.events.loaded.emit(),n.forEach(o=>console.warn(o)),n}finally{this._loading=!1}}save(){let t={graph:this.graph.save(),graphTemplates:this.graphTemplates.map(n=>n.save())};return this.hooks.save.execute(t)}};var Os={};Sn(Os,{BaseEngine:()=>An,CycleError:()=>Pn,DependencyEngine:()=>Ns,EngineStatus:()=>ke,allowMultipleConnections:()=>Ll,applyResult:()=>Ul,containsCycle:()=>ws,sortTopologically:()=>vo});function Ul(e,t){let n=new Map;t.graphs.forEach(o=>{o.nodes.forEach(s=>n.set(s.id,s))}),e.forEach((o,s)=>{let r=n.get(s);r&&o.forEach((i,a)=>{let c=r.outputs[a];c&&(c.value=i)})})}var Pn=class extends Error{constructor(){super("Cycle detected")}};function jl(e){return typeof e=="string"}function vo(e,t){let n=new Map,o=new Map,s=new Map,r,i;if(e instanceof qe)r=e.nodes,i=e.connections;else{if(!t)throw new Error("Invalid argument value: expected array of connections");r=e,i=t}r.forEach(l=>{Object.values(l.inputs).forEach(u=>n.set(u.id,l.id)),Object.values(l.outputs).forEach(u=>n.set(u.id,l.id))}),r.forEach(l=>{let u=i.filter(p=>p.from&&n.get(p.from.id)===l.id),d=new Set(u.map(p=>n.get(p.to.id)).filter(jl));o.set(l.id,d),s.set(l,u)});let a=r.slice();i.forEach(l=>{let u=a.findIndex(d=>n.get(l.to.id)===d.id);u>=0&&a.splice(u,1)});let c=[];for(;a.length>0;){let l=a.pop();c.push(l);let u=o.get(l.id);for(;u.size>0;){let d=u.values().next().value;if(u.delete(d),Array.from(o.values()).every(p=>!p.has(d))){let p=r.find(m=>m.id===d);a.push(p)}}}if(Array.from(o.values()).some(l=>l.size>0))throw new Pn;return{calculationOrder:c,connectionsFromNode:s,interfaceIdToNodeId:n}}function ws(e,t){try{return vo(e,t),!1}catch(n){if(n instanceof Pn)return!0;throw n}}var ke;(function(e){e.Running="Running",e.Idle="Idle",e.Paused="Paused",e.Stopped="Stopped"})(ke||(ke={}));var An=class{get status(){return this.isRunning?ke.Running:this.internalStatus}constructor(t){this.editor=t,this.events={beforeRun:new fe(this),afterRun:new Z(this),statusChange:new Z(this),beforeNodeCalculation:new Z(this),afterNodeCalculation:new Z(this)},this.hooks={gatherCalculationData:new me(this),transferData:new Vn},this.recalculateOrder=!0,this.internalStatus=ke.Stopped,this.isRunning=!1,this.editor.nodeEvents.update.subscribe(this,(n,o)=>{o.graph&&!o.graph.loading&&o.graph.activeTransactions===0&&this.internalOnChange(o,n??void 0)}),this.editor.graphEvents.addNode.subscribe(this,(n,o)=>{this.recalculateOrder=!0,!o.loading&&o.activeTransactions===0&&this.internalOnChange()}),this.editor.graphEvents.removeNode.subscribe(this,(n,o)=>{this.recalculateOrder=!0,!o.loading&&o.activeTransactions===0&&this.internalOnChange()}),this.editor.graphEvents.addConnection.subscribe(this,(n,o)=>{this.recalculateOrder=!0,!o.loading&&o.activeTransactions===0&&this.internalOnChange()}),this.editor.graphEvents.removeConnection.subscribe(this,(n,o)=>{this.recalculateOrder=!0,!o.loading&&o.activeTransactions===0&&this.internalOnChange()}),this.editor.graphHooks.checkConnection.subscribe(this,n=>this.checkConnection(n.from,n.to))}start(){this.internalStatus===ke.Stopped&&(this.internalStatus=ke.Idle,this.events.statusChange.emit(this.status))}pause(){this.internalStatus===ke.Idle&&(this.internalStatus=ke.Paused,this.events.statusChange.emit(this.status))}resume(){this.internalStatus===ke.Paused&&(this.internalStatus=ke.Idle,this.events.statusChange.emit(this.status))}stop(){(this.internalStatus===ke.Idle||this.internalStatus===ke.Paused)&&(this.internalStatus=ke.Stopped,this.events.statusChange.emit(this.status))}async runOnce(t,...n){if(this.events.beforeRun.emit(t).prevented)return null;try{this.isRunning=!0,this.events.statusChange.emit(this.status),this.recalculateOrder&&this.calculateOrder();let o=await this.execute(t,...n);return this.events.afterRun.emit(o),o}finally{this.isRunning=!1,this.events.statusChange.emit(this.status)}}checkConnection(t,n){if(t.templateId){let r=this.findInterfaceByTemplateId(this.editor.graph.nodes,t.templateId);if(!r)return{connectionAllowed:!0,connectionsInDanger:[]};t=r}if(n.templateId){let r=this.findInterfaceByTemplateId(this.editor.graph.nodes,n.templateId);if(!r)return{connectionAllowed:!0,connectionsInDanger:[]};n=r}let o=new jt(t,n),s=this.editor.graph.connections.slice();return n.allowMultipleConnections||(s=s.filter(r=>r.to!==n)),s.push(o),ws(this.editor.graph.nodes,s)?{connectionAllowed:!1,connectionsInDanger:[]}:{connectionAllowed:!0,connectionsInDanger:n.allowMultipleConnections?[]:this.editor.graph.connections.filter(r=>r.to===n)}}calculateOrder(){this.recalculateOrder=!0}async calculateWithoutData(...t){let n=this.hooks.gatherCalculationData.execute(void 0);return await this.runOnce(n,...t)}validateNodeCalculationOutput(t,n){if(typeof n!="object")throw new Error(`Invalid calculation return value from node ${t.id} (type ${t.type})`);Object.keys(t.outputs).forEach(o=>{if(!(o in n))throw new Error(`Calculation return value from node ${t.id} (type ${t.type}) is missing key "${o}"`)})}internalOnChange(t,n){this.internalStatus===ke.Idle&&this.onChange(this.recalculateOrder,t,n)}findInterfaceByTemplateId(t,n){for(let o of t)for(let s of[...Object.values(o.inputs),...Object.values(o.outputs)])if(s.templateId===n)return s;return null}};var Ll=e=>{e.allowMultipleConnections=!0},Ns=class extends An{constructor(t){super(t),this.order=new Map}start(){super.start(),this.recalculateOrder=!0,this.calculateWithoutData()}async runGraph(t,n,o){this.order.has(t.id)||this.order.set(t.id,vo(t));let{calculationOrder:s,connectionsFromNode:r}=this.order.get(t.id),i=new Map;for(let a of s){let c={};Object.entries(a.inputs).forEach(([u,d])=>{c[u]=this.getInterfaceValue(n,d.id)}),this.events.beforeNodeCalculation.emit({inputValues:c,node:a});let l;if(a.calculate)l=await a.calculate(c,{globalValues:o,engine:this});else{l={};for(let[u,d]of Object.entries(a.outputs))l[u]=this.getInterfaceValue(n,d.id)}this.validateNodeCalculationOutput(a,l),this.events.afterNodeCalculation.emit({outputValues:l,node:a}),i.set(a.id,new Map(Object.entries(l))),r.has(a)&&r.get(a).forEach(u=>{var d;let p=(d=Object.entries(a.outputs).find(([,v])=>v.id===u.from.id))===null||d===void 0?void 0:d[0];if(!p)throw new Error(`Could not find key for interface ${u.from.id}
This is likely a Baklava internal issue. Please report it on GitHub.`);let m=this.hooks.transferData.execute(l[p],u);u.to.allowMultipleConnections?n.has(u.to.id)?n.get(u.to.id).push(m):n.set(u.to.id,[m]):n.set(u.to.id,m)})}return i}async execute(t){this.recalculateOrder&&(this.order.clear(),this.recalculateOrder=!1);let n=new Map;for(let o of this.editor.graph.nodes)Object.values(o.inputs).forEach(s=>{s.connectionCount===0&&n.set(s.id,s.value)}),o.calculate||Object.values(o.outputs).forEach(s=>{n.set(s.id,s.value)});return await this.runGraph(this.editor.graph,n,t)}onChange(t){this.recalculateOrder=t||this.recalculateOrder,this.calculateWithoutData()}getInterfaceValue(t,n){if(!t.has(n))throw new Error(`Could not find value for interface ${n}
This is likely a Baklava internal issue. Please report it on GitHub.`);return t.get(n)}};var ks={};Sn(ks,{BaklavaInterfaceTypes:()=>xs,NodeInterfaceType:()=>Cs,setType:()=>Hl});var Cs=class{constructor(t){this.name=t,this.conversions=[]}addConversion(t,n=o=>o){return this.conversions.push({targetType:t.name,transformationFunction:n}),this}},Hl=(e,t)=>{e.type=t.name},xs=class{constructor(t,n){this.types=new Map,this.editor=t,this.editor.graphEvents.checkConnection.subscribe(this,({from:o,to:s},r)=>{let i=o.type,a=s.type;if(!(!i||!a)&&!this.canConvert(i,a))return r()}),n?.engine&&n.engine.hooks.transferData.subscribe(this,(o,s)=>{let r=s.from.type,i=s.to.type;return!r||!i?o:this.convert(r,i,o)}),n?.viewPlugin&&n.viewPlugin.hooks.renderInterface.subscribe(this,({intf:o,el:s})=>(o.type&&s.setAttribute("data-interface-type",o.type),{intf:o,el:s}))}addTypes(...t){return t.forEach(n=>{this.types.set(n.name,n)}),this}getConversion(t,n){var o,s;return(s=(o=this.types.get(t))===null||o===void 0?void 0:o.conversions.find(r=>r.targetType===n))!==null&&s!==void 0?s:null}canConvert(t,n){return t===n||this.types.has(t)&&this.types.get(t).conversions.some(o=>o.targetType===n)}convert(t,n,o){if(t===n)return o;{let s=this.getConversion(t,n);if(s)return s.transformationFunction(o);throw Error(`Can not convert from "${t}" to "${n}"`)}}};var ei={};Sn(ei,{ButtonInterface:()=>Vr,ButtonInterfaceComponent:()=>ml,CheckboxInterface:()=>$r,CheckboxInterfaceComponent:()=>vl,Commands:()=>kp,Components:()=>Hh,EditorComponent:()=>Zr,IntegerInterface:()=>Mr,IntegerInterfaceComponent:()=>gl,NumberInterface:()=>Pr,NumberInterfaceComponent:()=>yl,SelectInterface:()=>Ar,SelectInterfaceComponent:()=>_l,SliderInterface:()=>Rr,SliderInterfaceComponent:()=>bl,TextInputInterface:()=>lo,TextInputInterfaceComponent:()=>El,TextInterface:()=>Fr,getNodePosition:()=>dd,providePlugin:()=>sl,setNodePosition:()=>fd,useBaklava:()=>Qr,useCommandHandler:()=>xl,useDragMove:()=>Lr,useGraph:()=>Ze,useTransform:()=>rl,useViewModel:()=>Je});function ln(e,t){let n=Object.create(null),o=e.split(",");for(let s=0;s<o.length;s++)n[o[s]]=!0;return t?s=>!!n[s.toLowerCase()]:s=>!!n[s]}var ie={},Bt=[],Ve=()=>{},li=()=>!1,Bl=/^on[^a-z]/,cn=e=>Bl.test(e),Rn=e=>e.startsWith("onUpdate:"),pe=Object.assign,go=(e,t)=>{let n=e.indexOf(t);n>-1&&e.splice(n,1)},Kl=Object.prototype.hasOwnProperty,ee=(e,t)=>Kl.call(e,t),L=Array.isArray,Ot=e=>_o(e)==="[object Map]",yo=e=>_o(e)==="[object Set]";var W=e=>typeof e=="function",ue=e=>typeof e=="string",Fn=e=>typeof e=="symbol",oe=e=>e!==null&&typeof e=="object",Ts=e=>(oe(e)||W(e))&&W(e.then)&&W(e.catch),ci=Object.prototype.toString,_o=e=>ci.call(e),Ds=e=>_o(e).slice(8,-1),Is=e=>_o(e)==="[object Object]",bo=e=>ue(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Un=ln(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted");var Eo=e=>{let t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Wl=/-(\w)/g,$e=Eo(e=>e.replace(Wl,(t,n)=>n?n.toUpperCase():"")),zl=/\B([A-Z])/g,vt=Eo(e=>e.replace(zl,"-$1").toLowerCase()),Kt=Eo(e=>e.charAt(0).toUpperCase()+e.slice(1)),jn=Eo(e=>e?`on${Kt(e)}`:""),gt=(e,t)=>!Object.is(e,t),un=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},dn=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},Ln=e=>{let t=parseFloat(e);return isNaN(t)?e:t},Ss=e=>{let t=ue(e)?Number(e):NaN;return isNaN(t)?e:t},ai,fn=()=>ai||(ai=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Re(e){if(L(e)){let t={};for(let n=0;n<e.length;n++){let o=e[n],s=ue(o)?Xl(o):Re(o);if(s)for(let r in s)t[r]=s[r]}return t}else if(ue(e)||oe(e))return e}var ql=/;(?![^(]*\))/g,Gl=/:([^]+)/,Yl=/\/\*[^]*?\*\//g;function Xl(e){let t={};return e.replace(Yl,"").split(ql).forEach(n=>{if(n){let o=n.split(Gl);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function ge(e){let t="";if(ue(e))t=e;else if(L(e))for(let n=0;n<e.length;n++){let o=ge(e[n]);o&&(t+=o+" ")}else if(oe(e))for(let n in e)e[n]&&(t+=n+" ");return t.trim()}var ui="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",di=ln(ui),bv=ln(ui+",async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected");function Vs(e){return!!e||e===""}var ye=e=>ue(e)?e:e==null?"":L(e)||oe(e)&&(e.toString===ci||!W(e.toString))?JSON.stringify(e,fi,2):String(e),fi=(e,t)=>t&&t.__v_isRef?fi(e,t.value):Ot(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[o,s])=>(n[`${o} =>`]=s,n),{})}:yo(t)?{[`Set(${t.size})`]:[...t.values()]}:oe(t)&&!L(t)&&!Is(t)?String(t):t;var Fe,Bn=class{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Fe,!t&&Fe&&(this.index=(Fe.scopes||(Fe.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){let n=Fe;try{return Fe=this,t()}finally{Fe=n}}}on(){Fe=this}off(){Fe=this.parent}stop(t){if(this._active){let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.scopes)for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){let s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}};function Jl(e,t=Fe){t&&t.active&&t.effects.push(e)}function Wn(){return Fe}function Ls(e){Fe&&Fe.cleanups.push(e)}var Hs=e=>{let t=new Set(e);return t.w=0,t.n=0,t},bi=e=>(e.w&kt)>0,Ei=e=>(e.n&kt)>0,Zl=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=kt},Ql=e=>{let{deps:t}=e;if(t.length){let n=0;for(let o=0;o<t.length;o++){let s=t[o];bi(s)&&!Ei(s)?s.delete(e):t[n++]=s,s.w&=~kt,s.n&=~kt}t.length=n}},ko=new WeakMap,Hn=0,kt=1,$s=30,tt,Wt=Symbol(""),Ms=Symbol(""),zt=class{constructor(t,n=null,o){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Jl(this,o)}run(){if(!this.active)return this.fn();let t=tt,n=xt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=tt,tt=this,xt=!0,kt=1<<++Hn,Hn<=$s?Zl(this):pi(this),this.fn()}finally{Hn<=$s&&Ql(this),kt=1<<--Hn,tt=this.parent,xt=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){tt===this?this.deferStop=!0:this.active&&(pi(this),this.onStop&&this.onStop(),this.active=!1)}};function pi(e){let{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}var xt=!0,wi=[];function Dt(){wi.push(xt),xt=!1}function It(){let e=wi.pop();xt=e===void 0?!0:e}function Te(e,t,n){if(xt&&tt){let o=ko.get(e);o||ko.set(e,o=new Map);let s=o.get(n);s||o.set(n,s=Hs()),Ni(s,void 0)}}function Ni(e,t){let n=!1;Hn<=$s?Ei(e)||(e.n|=kt,n=!bi(e)):n=!e.has(tt),n&&(e.add(tt),tt.deps.push(e))}function at(e,t,n,o,s,r){let i=ko.get(e);if(!i)return;let a=[];if(t==="clear")a=[...i.values()];else if(n==="length"&&L(e)){let l=Number(o);i.forEach((u,d)=>{(d==="length"||!Fn(d)&&d>=l)&&a.push(u)})}else switch(n!==void 0&&a.push(i.get(n)),t){case"add":L(e)?bo(n)&&a.push(i.get("length")):(a.push(i.get(Wt)),Ot(e)&&a.push(i.get(Ms)));break;case"delete":L(e)||(a.push(i.get(Wt)),Ot(e)&&a.push(i.get(Ms)));break;case"set":Ot(e)&&a.push(i.get(Wt));break}let c=void 0;if(a.length===1)a[0]&&Ps(a[0]);else{let l=[];for(let u of a)u&&l.push(...u);Ps(Hs(l))}}function Ps(e,t){let n=L(e)?e:[...e];for(let o of n)o.computed&&hi(o,t);for(let o of n)o.computed||hi(o,t)}function hi(e,t){(e!==tt||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function ec(e,t){var n;return(n=ko.get(e))==null?void 0:n.get(t)}var tc=ln("__proto__,__v_isRef,__isVue"),Oi=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Fn)),mi=nc();function nc(){let e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){let o=Y(this);for(let r=0,i=this.length;r<i;r++)Te(o,"get",r+"");let s=o[t](...n);return s===-1||s===!1?o[t](...n.map(Y)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Dt();let o=Y(this)[t].apply(this,n);return It(),o}}),e}function oc(e){let t=Y(this);return Te(t,"has",e),t.hasOwnProperty(e)}var To=class{constructor(t=!1,n=!1){this._isReadonly=t,this._shallow=n}get(t,n,o){let s=this._isReadonly,r=this._shallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw"&&o===(s?r?Ti:ki:r?xi:Ci).get(t))return t;let i=L(t);if(!s){if(i&&ee(mi,n))return Reflect.get(mi,n,o);if(n==="hasOwnProperty")return oc}let a=Reflect.get(t,n,o);return(Fn(n)?Oi.has(n):tc(n))||(s||Te(t,"get",n),r)?a:he(a)?i&&bo(n)?a:a.value:oe(a)?s?Ws(a):Me(a):a}},Do=class extends To{constructor(t=!1){super(!1,t)}set(t,n,o,s){let r=t[n];if(Tt(r)&&he(r)&&!he(o))return!1;if(!this._shallow&&(!pn(o)&&!Tt(o)&&(r=Y(r),o=Y(o)),!L(t)&&he(r)&&!he(o)))return r.value=o,!0;let i=L(t)&&bo(n)?Number(n)<t.length:ee(t,n),a=Reflect.set(t,n,o,s);return t===Y(s)&&(i?gt(o,r)&&at(t,"set",n,o,r):at(t,"add",n,o)),a}deleteProperty(t,n){let o=ee(t,n),s=t[n],r=Reflect.deleteProperty(t,n);return r&&o&&at(t,"delete",n,void 0,s),r}has(t,n){let o=Reflect.has(t,n);return(!Fn(n)||!Oi.has(n))&&Te(t,"has",n),o}ownKeys(t){return Te(t,"iterate",L(t)?"length":Wt),Reflect.ownKeys(t)}},Io=class extends To{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}},sc=new Do,rc=new Io,ic=new Do(!0),ac=new Io(!0),Bs=e=>e,So=e=>Reflect.getPrototypeOf(e);function wo(e,t,n=!1,o=!1){e=e.__v_raw;let s=Y(e),r=Y(t);n||(gt(t,r)&&Te(s,"get",t),Te(s,"get",r));let{has:i}=So(s),a=o?Bs:n?qs:Kn;if(i.call(s,t))return a(e.get(t));if(i.call(s,r))return a(e.get(r));e!==s&&e.get(t)}function No(e,t=!1){let n=this.__v_raw,o=Y(n),s=Y(e);return t||(gt(e,s)&&Te(o,"has",e),Te(o,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function Oo(e,t=!1){return e=e.__v_raw,!t&&Te(Y(e),"iterate",Wt),Reflect.get(e,"size",e)}function vi(e){e=Y(e);let t=Y(this);return So(t).has.call(t,e)||(t.add(e),at(t,"add",e,e)),this}function gi(e,t){t=Y(t);let n=Y(this),{has:o,get:s}=So(n),r=o.call(n,e);r||(e=Y(e),r=o.call(n,e));let i=s.call(n,e);return n.set(e,t),r?gt(t,i)&&at(n,"set",e,t,i):at(n,"add",e,t),this}function yi(e){let t=Y(this),{has:n,get:o}=So(t),s=n.call(t,e);s||(e=Y(e),s=n.call(t,e));let r=o?o.call(t,e):void 0,i=t.delete(e);return s&&at(t,"delete",e,void 0,r),i}function _i(){let e=Y(this),t=e.size!==0,n=void 0,o=e.clear();return t&&at(e,"clear",void 0,void 0,n),o}function Co(e,t){return function(o,s){let r=this,i=r.__v_raw,a=Y(i),c=t?Bs:e?qs:Kn;return!e&&Te(a,"iterate",Wt),i.forEach((l,u)=>o.call(s,c(l),c(u),r))}}function xo(e,t,n){return function(...o){let s=this.__v_raw,r=Y(s),i=Ot(r),a=e==="entries"||e===Symbol.iterator&&i,c=e==="keys"&&i,l=s[e](...o),u=n?Bs:t?qs:Kn;return!t&&Te(r,"iterate",c?Ms:Wt),{next(){let{value:d,done:p}=l.next();return p?{value:d,done:p}:{value:a?[u(d[0]),u(d[1])]:u(d),done:p}},[Symbol.iterator](){return this}}}}function Ct(e){return function(...t){return e==="delete"?!1:this}}function lc(){let e={get(r){return wo(this,r)},get size(){return Oo(this)},has:No,add:vi,set:gi,delete:yi,clear:_i,forEach:Co(!1,!1)},t={get(r){return wo(this,r,!1,!0)},get size(){return Oo(this)},has:No,add:vi,set:gi,delete:yi,clear:_i,forEach:Co(!1,!0)},n={get(r){return wo(this,r,!0)},get size(){return Oo(this,!0)},has(r){return No.call(this,r,!0)},add:Ct("add"),set:Ct("set"),delete:Ct("delete"),clear:Ct("clear"),forEach:Co(!0,!1)},o={get(r){return wo(this,r,!0,!0)},get size(){return Oo(this,!0)},has(r){return No.call(this,r,!0)},add:Ct("add"),set:Ct("set"),delete:Ct("delete"),clear:Ct("clear"),forEach:Co(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=xo(r,!1,!1),n[r]=xo(r,!0,!1),t[r]=xo(r,!1,!0),o[r]=xo(r,!0,!0)}),[e,n,t,o]}var[cc,uc,dc,fc]=lc();function Vo(e,t){let n=t?e?fc:dc:e?uc:cc;return(o,s,r)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?o:Reflect.get(ee(n,s)&&s in o?n:o,s,r)}var pc={get:Vo(!1,!1)},hc={get:Vo(!1,!0)},mc={get:Vo(!0,!1)},vc={get:Vo(!0,!0)};var Ci=new WeakMap,xi=new WeakMap,ki=new WeakMap,Ti=new WeakMap;function gc(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yc(e){return e.__v_skip||!Object.isExtensible(e)?0:gc(Ds(e))}function Me(e){return Tt(e)?e:$o(e,!1,sc,pc,Ci)}function Ks(e){return $o(e,!1,ic,hc,xi)}function Ws(e){return $o(e,!0,rc,mc,ki)}function zs(e){return $o(e,!0,ac,vc,Ti)}function $o(e,t,n,o,s){if(!oe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;let r=s.get(e);if(r)return r;let i=yc(e);if(i===0)return e;let a=new Proxy(e,i===2?o:n);return s.set(e,a),a}function St(e){return Tt(e)?St(e.__v_raw):!!(e&&e.__v_isReactive)}function Tt(e){return!!(e&&e.__v_isReadonly)}function pn(e){return!!(e&&e.__v_isShallow)}function Mo(e){return St(e)||Tt(e)}function Y(e){let t=e&&e.__v_raw;return t?Y(t):e}function Ue(e){return dn(e,"__v_skip",!0),e}var Kn=e=>oe(e)?Me(e):e,qs=e=>oe(e)?Ws(e):e;function Gs(e){xt&&tt&&(e=Y(e),Ni(e.dep||(e.dep=Hs())))}function Ys(e,t){e=Y(e);let n=e.dep;n&&Ps(n)}function he(e){return!!(e&&e.__v_isRef===!0)}function H(e){return _c(e,!1)}function _c(e,t){return he(e)?e:new As(e,t)}var As=class{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:Y(t),this._value=n?t:Kn(t)}get value(){return Gs(this),this._value}set value(t){let n=this.__v_isShallow||pn(t)||Tt(t);t=n?t:Y(t),gt(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:Kn(t),Ys(this,t))}};function je(e){return he(e)?e.value:e}var bc={get:(e,t,n)=>je(Reflect.get(e,t,n)),set:(e,t,n,o)=>{let s=e[t];return he(s)&&!he(n)?(s.value=n,!0):Reflect.set(e,t,n,o)}};function Po(e){return St(e)?e:new Proxy(e,bc)}var Rs=class{constructor(t){this.dep=void 0,this.__v_isRef=!0;let{get:n,set:o}=t(()=>Gs(this),()=>Ys(this));this._get=n,this._set=o}get value(){return this._get()}set value(t){this._set(t)}};function Xs(e){return new Rs(e)}function Js(e){let t=L(e)?new Array(e.length):{};for(let n in e)t[n]=Di(e,n);return t}var Fs=class{constructor(t,n,o){this._object=t,this._key=n,this._defaultValue=o,this.__v_isRef=!0}get value(){let t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return ec(Y(this._object),this._key)}},Us=class{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}};function yt(e,t,n){return he(e)?e:W(e)?new Us(e):oe(e)&&arguments.length>1?Di(e,t,n):H(e)}function Di(e,t,n){let o=e[t];return he(o)?o:new Fs(e,t,n)}var js=class{constructor(t,n,o,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new zt(t,()=>{this._dirty||(this._dirty=!0,Ys(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){let t=Y(this);return Gs(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}};function Ii(e,t,n=!1){let o,s,r=W(e);return r?(o=e,s=Ve):(o=e.get,s=e.set),new js(o,s,r||!s,n)}var Gn=[];function Yi(e,...t){}function Ec(){let e=Gn[Gn.length-1];if(!e)return[];let t=[];for(;e;){let n=t[0];n&&n.vnode===e?n.recurseCount++:t.push({vnode:e,recurseCount:0});let o=e.component&&e.component.parent;e=o&&o.vnode}return t}function wc(e){let t=[];return e.forEach((n,o)=>{t.push(...o===0?[]:[`
`],...Nc(n))}),t}function Nc({vnode:e,recurseCount:t}){let n=t>0?`... (${t} recursive calls)`:"",o=e.component?e.component.parent==null:!1,s=` at <${Ta(e.component,e.type,o)}`,r=">"+n;return e.props?[s,...Oc(e.props),r]:[s+r]}function Oc(e){let t=[],n=Object.keys(e);return n.slice(0,3).forEach(o=>{t.push(...Xi(o,e[o]))}),n.length>3&&t.push(" ..."),t}function Xi(e,t,n){return ue(t)?(t=JSON.stringify(t),n?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?n?t:[`${e}=${t}`]:he(t)?(t=Xi(e,Y(t.value),!0),n?t:[`${e}=Ref<`,t,">"]):W(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=Y(t),n?t:[`${e}=`,t])}function bt(e,t,n,o){let s;try{s=o?e(...o):e()}catch(r){Bo(r,t,n)}return s}function Le(e,t,n,o){if(W(e)){let r=bt(e,t,n,o);return r&&Ts(r)&&r.catch(i=>{Bo(i,t,n)}),r}let s=[];for(let r=0;r<e.length;r++)s.push(Le(e[r],t,n,o));return s}function Bo(e,t,n,o=!0){let s=t?t.vnode:null;if(t){let r=t.parent,i=t.proxy,a=n;for(;r;){let l=r.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](e,i,a)===!1)return}r=r.parent}let c=t.appContext.config.errorHandler;if(c){bt(c,null,10,[e,i,a]);return}}Cc(e,n,s,o)}function Cc(e,t,n,o=!0){console.error(e)}var Zn=!1,tr=!1,Ce=[],ut=0,mn=[],_t=null,Yt=0,Ji=Promise.resolve(),lr=null;function bn(e){let t=lr||Ji;return e?t.then(this?e.bind(this):e):t}function xc(e){let t=ut+1,n=Ce.length;for(;t<n;){let o=t+n>>>1,s=Ce[o],r=Qn(s);r<e||r===e&&s.pre?t=o+1:n=o}return t}function cr(e){(!Ce.length||!Ce.includes(e,Zn&&e.allowRecurse?ut+1:ut))&&(e.id==null?Ce.push(e):Ce.splice(xc(e.id),0,e),Zi())}function Zi(){!Zn&&!tr&&(tr=!0,lr=Ji.then(ea))}function kc(e){let t=Ce.indexOf(e);t>ut&&Ce.splice(t,1)}function Tc(e){L(e)?mn.push(...e):(!_t||!_t.includes(e,e.allowRecurse?Yt+1:Yt))&&mn.push(e),Zi()}function Si(e,t=Zn?ut+1:0){for(;t<Ce.length;t++){let n=Ce[t];n&&n.pre&&(Ce.splice(t,1),t--,n())}}function Qi(e){if(mn.length){let t=[...new Set(mn)];if(mn.length=0,_t){_t.push(...t);return}for(_t=t,_t.sort((n,o)=>Qn(n)-Qn(o)),Yt=0;Yt<_t.length;Yt++)_t[Yt]();_t=null,Yt=0}}var Qn=e=>e.id==null?1/0:e.id,Dc=(e,t)=>{let n=Qn(e)-Qn(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function ea(e){tr=!1,Zn=!0,Ce.sort(Dc);let t=Ve;try{for(ut=0;ut<Ce.length;ut++){let n=Ce[ut];n&&n.active!==!1&&bt(n,null,14)}}finally{ut=0,Ce.length=0,Qi(e),Zn=!1,lr=null,(Ce.length||mn.length)&&ea(e)}}var dt,zn=[],nr=!1;function Ko(e,...t){dt?dt.emit(e,...t):nr||zn.push({event:e,args:t})}function ta(e,t){var n,o;dt=e,dt?(dt.enabled=!0,zn.forEach(({event:s,args:r})=>dt.emit(s,...r)),zn=[]):typeof window<"u"&&window.HTMLElement&&!((o=(n=window.navigator)==null?void 0:n.userAgent)!=null&&o.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(r=>{ta(r,t)}),setTimeout(()=>{dt||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,nr=!0,zn=[])},3e3)):(nr=!0,zn=[])}function Ic(e,t){Ko("app:init",e,t,{Fragment:ne,Text:no,Comment:He,Static:vn})}function Sc(e){Ko("app:unmount",e)}var Vc=ur("component:added"),na=ur("component:updated"),$c=ur("component:removed"),Mc=e=>{dt&&typeof dt.cleanupBuffer=="function"&&!dt.cleanupBuffer(e)&&$c(e)};function ur(e){return t=>{Ko(e,t.appContext.app,t.uid,t.parent?t.parent.uid:void 0,t)}}function Pc(e,t,n){Ko("component:emit",e.appContext.app,e,t,n)}function Ac(e,t,...n){if(e.isUnmounted)return;let o=e.vnode.props||ie,s=n,r=t.startsWith("update:"),i=r&&t.slice(7);if(i&&i in o){let u=`${i==="modelValue"?"model":i}Modifiers`,{number:d,trim:p}=o[u]||ie;p&&(s=n.map(m=>ue(m)?m.trim():m)),d&&(s=n.map(Ln))}__VUE_PROD_DEVTOOLS__&&Pc(e,t,s);let a,c=o[a=jn(t)]||o[a=jn($e(t))];!c&&r&&(c=o[a=jn(vt(t))]),c&&Le(c,e,6,s);let l=o[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Le(l,e,6,s)}}function oa(e,t,n=!1){let o=t.emitsCache,s=o.get(e);if(s!==void 0)return s;let r=e.emits,i={},a=!1;if(__VUE_OPTIONS_API__&&!W(e)){let c=l=>{let u=oa(l,t,!0);u&&(a=!0,pe(i,u))};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!r&&!a?(oe(e)&&o.set(e,null),null):(L(r)?r.forEach(c=>i[c]=null):pe(i,r),oe(e)&&o.set(e,i),i)}function Wo(e,t){return!e||!cn(t)?!1:(t=t.slice(2).replace(/Once$/,""),ee(e,t[0].toLowerCase()+t.slice(1))||ee(e,vt(t))||ee(e,t))}var we=null,sa=null;function Uo(e){let t=we;return we=e,sa=e&&e.type.__scopeId||null,t}function En(e,t=we,n){if(!t||e._n)return e;let o=(...s)=>{o._d&&Bi(-1);let r=Uo(t),i;try{i=e(...s)}finally{Uo(r),o._d&&Bi(1)}return __VUE_PROD_DEVTOOLS__&&na(t),i};return o._n=!0,o._c=!0,o._d=!0,o}function Zs(e){let{type:t,vnode:n,proxy:o,withProxy:s,props:r,propsOptions:[i],slots:a,attrs:c,emit:l,render:u,renderCache:d,data:p,setupState:m,ctx:v,inheritAttrs:y}=e,k,P,V=Uo(e);try{if(n.shapeFlag&4){let N=s||o;k=ct(u.call(N,N,d,r,m,p,v)),P=c}else{let N=t;k=ct(N.length>1?N(r,{attrs:c,slots:a,emit:l}):N(r,null)),P=t.props?c:Rc(c)}}catch(N){Jn.length=0,Bo(N,e,1),k=X(He)}let b=k,B;if(P&&y!==!1){let N=Object.keys(P),{shapeFlag:J}=b;N.length&&J&7&&(i&&N.some(Rn)&&(P=Fc(P,i)),b=Mt(b,P))}return n.dirs&&(b=Mt(b),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),k=b,Uo(V),k}var Rc=e=>{let t;for(let n in e)(n==="class"||n==="style"||cn(n))&&((t||(t={}))[n]=e[n]);return t},Fc=(e,t)=>{let n={};for(let o in e)(!Rn(o)||!(o.slice(9)in t))&&(n[o]=e[o]);return n};function Uc(e,t,n){let{props:o,children:s,component:r}=e,{props:i,children:a,patchFlag:c}=t,l=r.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return o?Vi(o,i,l):!!i;if(c&8){let u=t.dynamicProps;for(let d=0;d<u.length;d++){let p=u[d];if(i[p]!==o[p]&&!Wo(l,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:o===i?!1:o?i?Vi(o,i,l):!0:!!i;return!1}function Vi(e,t,n){let o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let s=0;s<o.length;s++){let r=o[s];if(t[r]!==e[r]&&!Wo(n,r))return!0}return!1}function jc({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}var dr="components";function ot(e,t){return ia(dr,e,!0,t)||e}var ra=Symbol.for("v-ndc");function zo(e){return ue(e)?ia(dr,e,!1)||e:e||ra}function ia(e,t,n=!0,o=!1){let s=we||be;if(s){let r=s.type;if(e===dr){let a=ka(r,!1);if(a&&(a===t||a===$e(t)||a===Kt($e(t))))return r}let i=$i(s[e]||r[e],t)||$i(s.appContext[e],t);return!i&&o?r:i}}function $i(e,t){return e&&(e[t]||e[$e(t)]||e[Kt($e(t))])}var Lc=e=>e.__isSuspense;function Hc(e,t){t&&t.pendingBranch?L(e)?t.effects.push(...e):t.effects.push(e):Tc(e)}var Ao={};function ft(e,t,n){return aa(e,t,n)}function aa(e,t,{immediate:n,deep:o,flush:s,onTrack:r,onTrigger:i}=ie){var a;let c=N=>{Yi("Invalid watch source: ",N,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},l=Wn()===((a=be)==null?void 0:a.scope)?be:null,u,d=!1,p=!1;if(he(e)?(u=()=>e.value,d=pn(e)):St(e)?(u=()=>e,o=!0):L(e)?(p=!0,d=e.some(N=>St(N)||pn(N)),u=()=>e.map(N=>{if(he(N))return N.value;if(St(N))return Jt(N);if(W(N))return bt(N,l,2)})):W(e)?t?u=()=>bt(e,l,2):u=()=>{if(!(l&&l.isUnmounted))return m&&m(),Le(e,l,3,[v])}:u=Ve,t&&o){let N=u;u=()=>Jt(N())}let m,v=N=>{m=b.onStop=()=>{bt(N,l,4)}},y;if(to)if(v=Ve,t?n&&Le(t,l,3,[u(),p?[]:void 0,v]):u(),s==="sync"){let N=$u();y=N.__watcherHandles||(N.__watcherHandles=[])}else return Ve;let k=p?new Array(e.length).fill(Ao):Ao,P=()=>{if(b.active)if(t){let N=b.run();(o||d||(p?N.some((J,C)=>gt(J,k[C])):gt(N,k)))&&(m&&m(),Le(t,l,3,[N,k===Ao?void 0:p&&k[0]===Ao?[]:k,v]),k=N)}else b.run()};P.allowRecurse=!!t;let V;s==="sync"?V=P:s==="post"?V=()=>Pe(P,l&&l.suspense):(P.pre=!0,l&&(P.id=l.uid),V=()=>cr(P));let b=new zt(u,V);t?n?P():k=b.run():s==="post"?Pe(b.run.bind(b),l&&l.suspense):b.run();let B=()=>{b.stop(),l&&l.scope&&go(l.scope.effects,b)};return y&&y.push(B),B}function Bc(e,t,n){let o=this.proxy,s=ue(e)?e.includes(".")?la(o,e):()=>o[e]:e.bind(o,o),r;W(t)?r=t:(r=t.handler,n=t);let i=be;_n(this);let a=aa(s,r.bind(o),n);return i?_n(i):Qt(),a}function la(e,t){let n=t.split(".");return()=>{let o=e;for(let s=0;s<n.length&&o;s++)o=o[n[s]];return o}}function Jt(e,t){if(!oe(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),he(e))Jt(e.value,t);else if(L(e))for(let n=0;n<e.length;n++)Jt(e[n],t);else if(yo(e)||Ot(e))e.forEach(n=>{Jt(n,t)});else if(Is(e))for(let n in e)Jt(e[n],t);return e}function Pt(e,t){let n=we;if(n===null)return e;let o=Qo(n)||n.proxy,s=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[i,a,c,l=ie]=t[r];i&&(W(i)&&(i={mounted:i,updated:i}),i.deep&&Jt(a),s.push({dir:i,instance:o,value:a,oldValue:void 0,arg:c,modifiers:l}))}return e}function qt(e,t,n,o){let s=e.dirs,r=t&&t.dirs;for(let i=0;i<s.length;i++){let a=s[i];r&&(a.oldValue=r[i].value);let c=a.dir[o];c&&(Dt(),Le(c,n,8,[e.el,a,e,t]),It())}}var Vt=Symbol("_leaveCb"),Ro=Symbol("_enterCb");function fr(){let e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return At(()=>{e.isMounted=!0}),Xo(()=>{e.isUnmounting=!0}),e}var Ge=[Function,Array],pr={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ge,onEnter:Ge,onAfterEnter:Ge,onEnterCancelled:Ge,onBeforeLeave:Ge,onLeave:Ge,onAfterLeave:Ge,onLeaveCancelled:Ge,onBeforeAppear:Ge,onAppear:Ge,onAfterAppear:Ge,onAppearCancelled:Ge},Kc={name:"BaseTransition",props:pr,setup(e,{slots:t}){let n=_r(),o=fr(),s;return()=>{let r=t.default&&qo(t.default(),!0);if(!r||!r.length)return;let i=r[0];if(r.length>1){let y=!1;for(let k of r)if(k.type!==He){i=k,y=!0;break}}let a=Y(e),{mode:c}=a;if(o.isLeaving)return Qs(i);let l=Mi(i);if(!l)return Qs(i);let u=gn(l,a,o,n);yn(l,u);let d=n.subTree,p=d&&Mi(d),m=!1,{getTransitionKey:v}=l.type;if(v){let y=v();s===void 0?s=y:y!==s&&(s=y,m=!0)}if(p&&p.type!==He&&(!Xt(l,p)||m)){let y=gn(p,a,o,n);if(yn(p,y),c==="out-in")return o.isLeaving=!0,y.afterLeave=()=>{o.isLeaving=!1,n.update.active!==!1&&n.update()},Qs(i);c==="in-out"&&l.type!==He&&(y.delayLeave=(k,P,V)=>{let b=ua(o,p);b[String(p.key)]=p,k[Vt]=()=>{P(),k[Vt]=void 0,delete u.delayedLeave},u.delayedLeave=V})}return i}}},ca=Kc;function ua(e,t){let{leavingVNodes:n}=e,o=n.get(t.type);return o||(o=Object.create(null),n.set(t.type,o)),o}function gn(e,t,n,o){let{appear:s,mode:r,persisted:i=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:d,onLeave:p,onAfterLeave:m,onLeaveCancelled:v,onBeforeAppear:y,onAppear:k,onAfterAppear:P,onAppearCancelled:V}=t,b=String(e.key),B=ua(n,e),N=(I,S)=>{I&&Le(I,o,9,S)},J=(I,S)=>{let K=S[1];N(I,S),L(I)?I.every(G=>G.length<=1)&&K():I.length<=1&&K()},C={mode:r,persisted:i,beforeEnter(I){let S=a;if(!n.isMounted)if(s)S=y||a;else return;I[Vt]&&I[Vt](!0);let K=B[b];K&&Xt(e,K)&&K.el[Vt]&&K.el[Vt](),N(S,[I])},enter(I){let S=c,K=l,G=u;if(!n.isMounted)if(s)S=k||c,K=P||l,G=V||u;else return;let A=!1,te=I[Ro]=xe=>{A||(A=!0,xe?N(G,[I]):N(K,[I]),C.delayedLeave&&C.delayedLeave(),I[Ro]=void 0)};S?J(S,[I,te]):te()},leave(I,S){let K=String(e.key);if(I[Ro]&&I[Ro](!0),n.isUnmounting)return S();N(d,[I]);let G=!1,A=I[Vt]=te=>{G||(G=!0,S(),te?N(v,[I]):N(m,[I]),I[Vt]=void 0,B[K]===e&&delete B[K])};B[K]=e,p?J(p,[I,A]):A()},clone(I){return gn(I,t,n,o)}};return C}function Qs(e){if(Go(e))return e=Mt(e),e.children=null,e}function Mi(e){return Go(e)?e.children?e.children[0]:void 0:e}function yn(e,t){e.shapeFlag&6&&e.component?yn(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function qo(e,t=!1,n){let o=[],s=0;for(let r=0;r<e.length;r++){let i=e[r],a=n==null?i.key:String(n)+String(i.key!=null?i.key:r);i.type===ne?(i.patchFlag&128&&s++,o=o.concat(qo(i.children,t,a))):(t||i.type!==He)&&o.push(a!=null?Mt(i,{key:a}):i)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}function de(e,t){return W(e)?(()=>pe({name:e.name},t,{setup:e}))():e}var Yn=e=>!!e.type.__asyncLoader;var Go=e=>e.type.__isKeepAlive;function Wc(e,t){da(e,"a",t)}function zc(e,t){da(e,"da",t)}function da(e,t,n=be){let o=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Yo(t,o,n),n){let s=n.parent;for(;s&&s.parent;)Go(s.parent.vnode)&&qc(o,t,n,s),s=s.parent}}function qc(e,t,n,o){let s=Yo(t,e,o,!0);hr(()=>{go(o[t],s)},n)}function Yo(e,t,n=be,o=!1){if(n){let s=n[e]||(n[e]=[]),r=t.__weh||(t.__weh=(...i)=>{if(n.isUnmounted)return;Dt(),_n(n);let a=Le(t,n,e,i);return Qt(),It(),a});return o?s.unshift(r):s.push(r),r}}var Et=e=>(t,n=be)=>(!to||e==="sp")&&Yo(e,(...o)=>t(...o),n),Gc=Et("bm"),At=Et("m"),Yc=Et("bu"),wn=Et("u"),Xo=Et("bum"),hr=Et("um"),Xc=Et("sp"),Jc=Et("rtg"),Zc=Et("rtc");function Qc(e,t=be){Yo("ec",e,t)}function Ye(e,t,n,o){let s,r=n&&n[o];if(L(e)||ue(e)){s=new Array(e.length);for(let i=0,a=e.length;i<a;i++)s[i]=t(e[i],i,void 0,r&&r[i])}else if(typeof e=="number"){s=new Array(e);for(let i=0;i<e;i++)s[i]=t(i+1,i,void 0,r&&r[i])}else if(oe(e))if(e[Symbol.iterator])s=Array.from(e,(i,a)=>t(i,a,void 0,r&&r[a]));else{let i=Object.keys(e);s=new Array(i.length);for(let a=0,c=i.length;a<c;a++){let l=i[a];s[a]=t(e[l],l,a,r&&r[a])}}else s=[];return n&&(n[o]=s),s}function Be(e,t,n={},o,s){if(we.isCE||we.parent&&Yn(we.parent)&&we.parent.isCE)return t!=="default"&&(n.name=t),X("slot",n,o&&o());let r=e[t];r&&r._c&&(r._d=!1),D();let i=r&&fa(r(n)),a=Ie(ne,{key:n.key||i&&i.key||`_${t}`},i||(o?o():[]),i&&e._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function fa(e){return e.some(t=>Ho(t)?!(t.type===He||t.type===ne&&!fa(t.children)):!0)?e:null}var or=e=>e?Ca(e)?Qo(e)||e.proxy:or(e.parent):null,Xn=pe(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>or(e.parent),$root:e=>or(e.root),$emit:e=>e.emit,$options:e=>__VUE_OPTIONS_API__?mr(e):e.type,$forceUpdate:e=>e.f||(e.f=()=>cr(e.update)),$nextTick:e=>e.n||(e.n=bn.bind(e.proxy)),$watch:e=>__VUE_OPTIONS_API__?Bc.bind(e):Ve});var er=(e,t)=>e!==ie&&!e.__isScriptSetup&&ee(e,t),eu={get({_:e},t){let{ctx:n,setupState:o,data:s,props:r,accessCache:i,type:a,appContext:c}=e,l;if(t[0]!=="$"){let m=i[t];if(m!==void 0)switch(m){case 1:return o[t];case 2:return s[t];case 4:return n[t];case 3:return r[t]}else{if(er(o,t))return i[t]=1,o[t];if(s!==ie&&ee(s,t))return i[t]=2,s[t];if((l=e.propsOptions[0])&&ee(l,t))return i[t]=3,r[t];if(n!==ie&&ee(n,t))return i[t]=4,n[t];(!__VUE_OPTIONS_API__||sr)&&(i[t]=0)}}let u=Xn[t],d,p;if(u)return t==="$attrs"&&Te(e,"get",t),u(e);if((d=a.__cssModules)&&(d=d[t]))return d;if(n!==ie&&ee(n,t))return i[t]=4,n[t];if(p=c.config.globalProperties,ee(p,t))return p[t]},set({_:e},t,n){let{data:o,setupState:s,ctx:r}=e;return er(s,t)?(s[t]=n,!0):o!==ie&&ee(o,t)?(o[t]=n,!0):ee(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:o,appContext:s,propsOptions:r}},i){let a;return!!n[i]||e!==ie&&ee(e,i)||er(t,i)||(a=r[0])&&ee(a,i)||ee(o,i)||ee(Xn,i)||ee(s.config.globalProperties,i)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ee(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Pi(e){return L(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}var sr=!0;function tu(e){let t=mr(e),n=e.proxy,o=e.ctx;sr=!1,t.beforeCreate&&Ai(t.beforeCreate,e,"bc");let{data:s,computed:r,methods:i,watch:a,provide:c,inject:l,created:u,beforeMount:d,mounted:p,beforeUpdate:m,updated:v,activated:y,deactivated:k,beforeDestroy:P,beforeUnmount:V,destroyed:b,unmounted:B,render:N,renderTracked:J,renderTriggered:C,errorCaptured:I,serverPrefetch:S,expose:K,inheritAttrs:G,components:A,directives:te,filters:xe}=t;if(l&&nu(l,o,null),i)for(let le in i){let re=i[le];W(re)&&(o[le]=re.bind(n))}if(s){let le=s.call(n,n);oe(le)&&(e.data=Me(le))}if(sr=!0,r)for(let le in r){let re=r[le],pt=W(re)?re.bind(n,n):W(re.get)?re.get.bind(n,n):Ve,hs=!W(re)&&W(re.set)?re.set.bind(n):Ve,Dn=z({get:pt,set:hs});Object.defineProperty(o,le,{enumerable:!0,configurable:!0,get:()=>Dn.value,set:nn=>Dn.value=nn})}if(a)for(let le in a)pa(a[le],o,n,le);if(c){let le=W(c)?c.call(n):c;Reflect.ownKeys(le).forEach(re=>{Jo(re,le[re])})}u&&Ai(u,e,"c");function ve(le,re){L(re)?re.forEach(pt=>le(pt.bind(n))):re&&le(re.bind(n))}if(ve(Gc,d),ve(At,p),ve(Yc,m),ve(wn,v),ve(Wc,y),ve(zc,k),ve(Qc,I),ve(Zc,J),ve(Jc,C),ve(Xo,V),ve(hr,B),ve(Xc,S),L(K))if(K.length){let le=e.exposed||(e.exposed={});K.forEach(re=>{Object.defineProperty(le,re,{get:()=>n[re],set:pt=>n[re]=pt})})}else e.exposed||(e.exposed={});N&&e.render===Ve&&(e.render=N),G!=null&&(e.inheritAttrs=G),A&&(e.components=A),te&&(e.directives=te)}function nu(e,t,n=Ve){L(e)&&(e=rr(e));for(let o in e){let s=e[o],r;oe(s)?"default"in s?r=Zt(s.from||o,s.default,!0):r=Zt(s.from||o):r=Zt(s),he(r)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:i=>r.value=i}):t[o]=r}}function Ai(e,t,n){Le(L(e)?e.map(o=>o.bind(t.proxy)):e.bind(t.proxy),t,n)}function pa(e,t,n,o){let s=o.includes(".")?la(n,o):()=>n[o];if(ue(e)){let r=t[e];W(r)&&ft(s,r)}else if(W(e))ft(s,e.bind(n));else if(oe(e))if(L(e))e.forEach(r=>pa(r,t,n,o));else{let r=W(e.handler)?e.handler.bind(n):t[e.handler];W(r)&&ft(s,r,e)}}function mr(e){let t=e.type,{mixins:n,extends:o}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:i}}=e.appContext,a=r.get(t),c;return a?c=a:!s.length&&!n&&!o?c=t:(c={},s.length&&s.forEach(l=>jo(c,l,i,!0)),jo(c,t,i)),oe(t)&&r.set(t,c),c}function jo(e,t,n,o=!1){let{mixins:s,extends:r}=t;r&&jo(e,r,n,!0),s&&s.forEach(i=>jo(e,i,n,!0));for(let i in t)if(!(o&&i==="expose")){let a=ou[i]||n&&n[i];e[i]=a?a(e[i],t[i]):t[i]}return e}var ou={data:Ri,props:Fi,emits:Fi,methods:qn,computed:qn,beforeCreate:De,created:De,beforeMount:De,mounted:De,beforeUpdate:De,updated:De,beforeDestroy:De,beforeUnmount:De,destroyed:De,unmounted:De,activated:De,deactivated:De,errorCaptured:De,serverPrefetch:De,components:qn,directives:qn,watch:ru,provide:Ri,inject:su};function Ri(e,t){return t?e?function(){return pe(W(e)?e.call(this,this):e,W(t)?t.call(this,this):t)}:t:e}function su(e,t){return qn(rr(e),rr(t))}function rr(e){if(L(e)){let t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function De(e,t){return e?[...new Set([].concat(e,t))]:t}function qn(e,t){return e?pe(Object.create(null),e,t):t}function Fi(e,t){return e?L(e)&&L(t)?[...new Set([...e,...t])]:pe(Object.create(null),Pi(e),Pi(t??{})):t}function ru(e,t){if(!e)return t;if(!t)return e;let n=pe(Object.create(null),e);for(let o in t)n[o]=De(e[o],t[o]);return n}function ha(){return{app:null,config:{isNativeTag:li,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}var iu=0;function au(e,t){return function(o,s=null){W(o)||(o=pe({},o)),s!=null&&!oe(s)&&(s=null);let r=ha(),i=new WeakSet,a=!1,c=r.app={_uid:iu++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:Gi,get config(){return r.config},set config(l){},use(l,...u){return i.has(l)||(l&&W(l.install)?(i.add(l),l.install(c,...u)):W(l)&&(i.add(l),l(c,...u))),c},mixin(l){return __VUE_OPTIONS_API__&&(r.mixins.includes(l)||r.mixins.push(l)),c},component(l,u){return u?(r.components[l]=u,c):r.components[l]},directive(l,u){return u?(r.directives[l]=u,c):r.directives[l]},mount(l,u,d){if(!a){let p=X(o,s);return p.appContext=r,u&&t?t(p,l):e(p,l,d),a=!0,c._container=l,l.__vue_app__=c,__VUE_PROD_DEVTOOLS__&&(c._instance=p.component,Ic(c,Gi)),Qo(p.component)||p.component.proxy}},unmount(){a&&(e(null,c._container),__VUE_PROD_DEVTOOLS__&&(c._instance=null,Sc(c)),delete c._container.__vue_app__)},provide(l,u){return r.provides[l]=u,c},runWithContext(l){Lo=c;try{return l()}finally{Lo=null}}};return c}}var Lo=null;function Jo(e,t){if(be){let n=be.provides,o=be.parent&&be.parent.provides;o===n&&(n=be.provides=Object.create(o)),n[e]=t}}function Zt(e,t,n=!1){let o=be||we;if(o||Lo){let s=o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:Lo._context.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&W(t)?t.call(o&&o.proxy):t}}function lu(e,t,n,o=!1){let s={},r={};dn(r,Zo,1),e.propsDefaults=Object.create(null),ma(e,t,s,r);for(let i in e.propsOptions[0])i in s||(s[i]=void 0);n?e.props=o?s:Ks(s):e.type.props?e.props=s:e.props=r,e.attrs=r}function cu(e,t,n,o){let{props:s,attrs:r,vnode:{patchFlag:i}}=e,a=Y(s),[c]=e.propsOptions,l=!1;if((o||i>0)&&!(i&16)){if(i&8){let u=e.vnode.dynamicProps;for(let d=0;d<u.length;d++){let p=u[d];if(Wo(e.emitsOptions,p))continue;let m=t[p];if(c)if(ee(r,p))m!==r[p]&&(r[p]=m,l=!0);else{let v=$e(p);s[v]=ir(c,a,v,m,e,!1)}else m!==r[p]&&(r[p]=m,l=!0)}}}else{ma(e,t,s,r)&&(l=!0);let u;for(let d in a)(!t||!ee(t,d)&&((u=vt(d))===d||!ee(t,u)))&&(c?n&&(n[d]!==void 0||n[u]!==void 0)&&(s[d]=ir(c,a,d,void 0,e,!0)):delete s[d]);if(r!==a)for(let d in r)(!t||!ee(t,d))&&(delete r[d],l=!0)}l&&at(e,"set","$attrs")}function ma(e,t,n,o){let[s,r]=e.propsOptions,i=!1,a;if(t)for(let c in t){if(Un(c))continue;let l=t[c],u;s&&ee(s,u=$e(c))?!r||!r.includes(u)?n[u]=l:(a||(a={}))[u]=l:Wo(e.emitsOptions,c)||(!(c in o)||l!==o[c])&&(o[c]=l,i=!0)}if(r){let c=Y(n),l=a||ie;for(let u=0;u<r.length;u++){let d=r[u];n[d]=ir(s,c,d,l[d],e,!ee(l,d))}}return i}function ir(e,t,n,o,s,r){let i=e[n];if(i!=null){let a=ee(i,"default");if(a&&o===void 0){let c=i.default;if(i.type!==Function&&!i.skipFactory&&W(c)){let{propsDefaults:l}=s;n in l?o=l[n]:(_n(s),o=l[n]=c.call(null,t),Qt())}else o=c}i[0]&&(r&&!a?o=!1:i[1]&&(o===""||o===vt(n))&&(o=!0))}return o}function va(e,t,n=!1){let o=t.propsCache,s=o.get(e);if(s)return s;let r=e.props,i={},a=[],c=!1;if(__VUE_OPTIONS_API__&&!W(e)){let u=d=>{c=!0;let[p,m]=va(d,t,!0);pe(i,p),m&&a.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!r&&!c)return oe(e)&&o.set(e,Bt),Bt;if(L(r))for(let u=0;u<r.length;u++){let d=$e(r[u]);Ui(d)&&(i[d]=ie)}else if(r)for(let u in r){let d=$e(u);if(Ui(d)){let p=r[u],m=i[d]=L(p)||W(p)?{type:p}:pe({},p);if(m){let v=Hi(Boolean,m.type),y=Hi(String,m.type);m[0]=v>-1,m[1]=y<0||v<y,(v>-1||ee(m,"default"))&&a.push(d)}}}let l=[i,a];return oe(e)&&o.set(e,l),l}function Ui(e){return e[0]!=="$"}function ji(e){let t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function Li(e,t){return ji(e)===ji(t)}function Hi(e,t){return L(t)?t.findIndex(n=>Li(n,e)):W(t)&&Li(t,e)?0:-1}var ga=e=>e[0]==="_"||e==="$stable",vr=e=>L(e)?e.map(ct):[ct(e)],uu=(e,t,n)=>{if(t._n)return t;let o=En((...s)=>vr(t(...s)),n);return o._c=!1,o},ya=(e,t,n)=>{let o=e._ctx;for(let s in e){if(ga(s))continue;let r=e[s];if(W(r))t[s]=uu(s,r,o);else if(r!=null){let i=vr(r);t[s]=()=>i}}},_a=(e,t)=>{let n=vr(t);e.slots.default=()=>n},du=(e,t)=>{if(e.vnode.shapeFlag&32){let n=t._;n?(e.slots=Y(t),dn(t,"_",n)):ya(t,e.slots={})}else e.slots={},t&&_a(e,t);dn(e.slots,Zo,1)},fu=(e,t,n)=>{let{vnode:o,slots:s}=e,r=!0,i=ie;if(o.shapeFlag&32){let a=t._;a?n&&a===1?r=!1:(pe(s,t),!n&&a===1&&delete s._):(r=!t.$stable,ya(t,s)),i=t}else t&&(_a(e,t),i={default:1});if(r)for(let a in s)!ga(a)&&i[a]==null&&delete s[a]};function ar(e,t,n,o,s=!1){if(L(e)){e.forEach((p,m)=>ar(p,t&&(L(t)?t[m]:t),n,o,s));return}if(Yn(o)&&!s)return;let r=o.shapeFlag&4?Qo(o.component)||o.component.proxy:o.el,i=s?null:r,{i:a,r:c}=e,l=t&&t.r,u=a.refs===ie?a.refs={}:a.refs,d=a.setupState;if(l!=null&&l!==c&&(ue(l)?(u[l]=null,ee(d,l)&&(d[l]=null)):he(l)&&(l.value=null)),W(c))bt(c,a,12,[i,u]);else{let p=ue(c),m=he(c);if(p||m){let v=()=>{if(e.f){let y=p?ee(d,c)?d[c]:u[c]:c.value;s?L(y)&&go(y,r):L(y)?y.includes(r)||y.push(r):p?(u[c]=[r],ee(d,c)&&(d[c]=u[c])):(c.value=[r],e.k&&(u[e.k]=c.value))}else p?(u[c]=i,ee(d,c)&&(d[c]=i)):m&&(c.value=i,e.k&&(u[e.k]=i))};i?(v.id=-1,Pe(v,n)):v()}}}function pu(){let e=[];typeof __VUE_OPTIONS_API__!="boolean"&&(fn().__VUE_OPTIONS_API__=!0),typeof __VUE_PROD_DEVTOOLS__!="boolean"&&(fn().__VUE_PROD_DEVTOOLS__=!1)}var Pe=Hc;function ba(e){return hu(e)}function hu(e,t){pu();let n=fn();n.__VUE__=!0,__VUE_PROD_DEVTOOLS__&&ta(n.__VUE_DEVTOOLS_GLOBAL_HOOK__,n);let{insert:o,remove:s,patchProp:r,createElement:i,createText:a,createComment:c,setText:l,setElementText:u,parentNode:d,nextSibling:p,setScopeId:m=Ve,insertStaticContent:v}=e,y=(f,h,g,_=null,E=null,x=null,$=!1,O=null,T=!!h.dynamicChildren)=>{if(f===h)return;f&&!Xt(f,h)&&(_=fo(f),Nt(f,E,x,!0),f=null),h.patchFlag===-2&&(T=!1,h.dynamicChildren=null);let{type:w,ref:U,shapeFlag:F}=h;switch(w){case no:k(f,h,g,_);break;case He:P(f,h,g,_);break;case vn:f==null&&V(h,g,_,$);break;case ne:te(f,h,g,_,E,x,$,O,T);break;default:F&1?J(f,h,g,_,E,x,$,O,T):F&6?xe(f,h,g,_,E,x,$,O,T):(F&64||F&128)&&w.process(f,h,g,_,E,x,$,O,T,on)}U!=null&&E&&ar(U,f&&f.ref,x,h||f,!h)},k=(f,h,g,_)=>{if(f==null)o(h.el=a(h.children),g,_);else{let E=h.el=f.el;h.children!==f.children&&l(E,h.children)}},P=(f,h,g,_)=>{f==null?o(h.el=c(h.children||""),g,_):h.el=f.el},V=(f,h,g,_)=>{[f.el,f.anchor]=v(f.children,h,g,_,f.el,f.anchor)},b=(f,h,g,_)=>{if(h.children!==f.children){let E=p(f.anchor);N(f),[h.el,h.anchor]=v(h.children,g,E,_)}else h.el=f.el,h.anchor=f.anchor},B=({el:f,anchor:h},g,_)=>{let E;for(;f&&f!==h;)E=p(f),o(f,g,_),f=E;o(h,g,_)},N=({el:f,anchor:h})=>{let g;for(;f&&f!==h;)g=p(f),s(f),f=g;s(h)},J=(f,h,g,_,E,x,$,O,T)=>{$=$||h.type==="svg",f==null?C(h,g,_,E,x,$,O,T):K(f,h,E,x,$,O,T)},C=(f,h,g,_,E,x,$,O)=>{let T,w,{type:U,props:F,shapeFlag:j,transition:q,dirs:Q}=f;if(T=f.el=i(f.type,x,F&&F.is,F),j&8?u(T,f.children):j&16&&S(f.children,T,null,_,E,x&&U!=="foreignObject",$,O),Q&&qt(f,null,_,"created"),I(T,f,f.scopeId,$,_),F){for(let se in F)se!=="value"&&!Un(se)&&r(T,se,null,F[se],x,f.children,_,E,ht);"value"in F&&r(T,"value",null,F.value),(w=F.onVnodeBeforeMount)&&lt(w,_,f)}__VUE_PROD_DEVTOOLS__&&(Object.defineProperty(T,"__vnode",{value:f,enumerable:!1}),Object.defineProperty(T,"__vueParentComponent",{value:_,enumerable:!1})),Q&&qt(f,null,_,"beforeMount");let ce=mu(E,q);ce&&q.beforeEnter(T),o(T,h,g),((w=F&&F.onVnodeMounted)||ce||Q)&&Pe(()=>{w&&lt(w,_,f),ce&&q.enter(T),Q&&qt(f,null,_,"mounted")},E)},I=(f,h,g,_,E)=>{if(g&&m(f,g),_)for(let x=0;x<_.length;x++)m(f,_[x]);if(E){let x=E.subTree;if(h===x){let $=E.vnode;I(f,$,$.scopeId,$.slotScopeIds,E.parent)}}},S=(f,h,g,_,E,x,$,O,T=0)=>{for(let w=T;w<f.length;w++){let U=f[w]=O?$t(f[w]):ct(f[w]);y(null,U,h,g,_,E,x,$,O)}},K=(f,h,g,_,E,x,$)=>{let O=h.el=f.el,{patchFlag:T,dynamicChildren:w,dirs:U}=h;T|=f.patchFlag&16;let F=f.props||ie,j=h.props||ie,q;g&&Gt(g,!1),(q=j.onVnodeBeforeUpdate)&&lt(q,g,h,f),U&&qt(h,f,g,"beforeUpdate"),g&&Gt(g,!0);let Q=E&&h.type!=="foreignObject";if(w?G(f.dynamicChildren,w,O,g,_,Q,x):$||pt(f,h,O,null,g,_,Q,x,!1),T>0){if(T&16)A(O,h,F,j,g,_,E);else if(T&2&&F.class!==j.class&&r(O,"class",null,j.class,E),T&4&&r(O,"style",F.style,j.style,E),T&8){let ce=h.dynamicProps;for(let se=0;se<ce.length;se++){let _e=ce[se],et=F[_e],sn=j[_e];(sn!==et||_e==="value")&&r(O,_e,et,sn,E,f.children,g,_,ht)}}T&1&&f.children!==h.children&&u(O,h.children)}else!$&&w==null&&A(O,h,F,j,g,_,E);((q=j.onVnodeUpdated)||U)&&Pe(()=>{q&&lt(q,g,h,f),U&&qt(h,f,g,"updated")},_)},G=(f,h,g,_,E,x,$)=>{for(let O=0;O<h.length;O++){let T=f[O],w=h[O],U=T.el&&(T.type===ne||!Xt(T,w)||T.shapeFlag&70)?d(T.el):g;y(T,w,U,null,_,E,x,$,!0)}},A=(f,h,g,_,E,x,$)=>{if(g!==_){if(g!==ie)for(let O in g)!Un(O)&&!(O in _)&&r(f,O,g[O],null,$,h.children,E,x,ht);for(let O in _){if(Un(O))continue;let T=_[O],w=g[O];T!==w&&O!=="value"&&r(f,O,w,T,$,h.children,E,x,ht)}"value"in _&&r(f,"value",g.value,_.value)}},te=(f,h,g,_,E,x,$,O,T)=>{let w=h.el=f?f.el:a(""),U=h.anchor=f?f.anchor:a(""),{patchFlag:F,dynamicChildren:j,slotScopeIds:q}=h;q&&(O=O?O.concat(q):q),f==null?(o(w,g,_),o(U,g,_),S(h.children,g,U,E,x,$,O,T)):F>0&&F&64&&j&&f.dynamicChildren?(G(f.dynamicChildren,j,g,E,x,$,O),(h.key!=null||E&&h===E.subTree)&&Ea(f,h,!0)):pt(f,h,g,U,E,x,$,O,T)},xe=(f,h,g,_,E,x,$,O,T)=>{h.slotScopeIds=O,f==null?h.shapeFlag&512?E.ctx.activate(h,g,_,$,T):Qe(h,g,_,E,x,$,T):ve(f,h,T)},Qe=(f,h,g,_,E,x,$)=>{let O=f.component=Ou(f,_,E);if(Go(f)&&(O.ctx.renderer=on),Cu(O),O.asyncDep){if(E&&E.registerDep(O,le),!f.el){let T=O.subTree=X(He);P(null,T,h,g)}return}le(O,f,h,g,E,x,$)},ve=(f,h,g)=>{let _=h.component=f.component;if(Uc(f,h,g))if(_.asyncDep&&!_.asyncResolved){re(_,h,g);return}else _.next=h,kc(_.update),_.update();else h.el=f.el,_.vnode=h},le=(f,h,g,_,E,x,$)=>{let O=()=>{if(f.isMounted){let{next:U,bu:F,u:j,parent:q,vnode:Q}=f,ce=U,se;Gt(f,!1),U?(U.el=Q.el,re(f,U,$)):U=Q,F&&un(F),(se=U.props&&U.props.onVnodeBeforeUpdate)&&lt(se,q,U,Q),Gt(f,!0);let _e=Zs(f),et=f.subTree;f.subTree=_e,y(et,_e,d(et.el),fo(et),f,E,x),U.el=_e.el,ce===null&&jc(f,_e.el),j&&Pe(j,E),(se=U.props&&U.props.onVnodeUpdated)&&Pe(()=>lt(se,q,U,Q),E),__VUE_PROD_DEVTOOLS__&&na(f)}else{let U,{el:F,props:j}=h,{bm:q,m:Q,parent:ce}=f,se=Yn(h);if(Gt(f,!1),q&&un(q),!se&&(U=j&&j.onVnodeBeforeMount)&&lt(U,ce,h),Gt(f,!0),F&&vs){let _e=()=>{f.subTree=Zs(f),vs(F,f.subTree,f,E,null)};se?h.type.__asyncLoader().then(()=>!f.isUnmounted&&_e()):_e()}else{let _e=f.subTree=Zs(f);y(null,_e,g,_,f,E,x),h.el=_e.el}if(Q&&Pe(Q,E),!se&&(U=j&&j.onVnodeMounted)){let _e=h;Pe(()=>lt(U,ce,_e),E)}(h.shapeFlag&256||ce&&Yn(ce.vnode)&&ce.vnode.shapeFlag&256)&&f.a&&Pe(f.a,E),f.isMounted=!0,__VUE_PROD_DEVTOOLS__&&Vc(f),h=g=_=null}},T=f.effect=new zt(O,()=>cr(w),f.scope),w=f.update=()=>T.run();w.id=f.uid,Gt(f,!0),w()},re=(f,h,g)=>{h.component=f;let _=f.vnode.props;f.vnode=h,f.next=null,cu(f,h.props,_,g),fu(f,h.children,g),Dt(),Si(),It()},pt=(f,h,g,_,E,x,$,O,T=!1)=>{let w=f&&f.children,U=f?f.shapeFlag:0,F=h.children,{patchFlag:j,shapeFlag:q}=h;if(j>0){if(j&128){Dn(w,F,g,_,E,x,$,O,T);return}else if(j&256){hs(w,F,g,_,E,x,$,O,T);return}}q&8?(U&16&&ht(w,E,x),F!==w&&u(g,F)):U&16?q&16?Dn(w,F,g,_,E,x,$,O,T):ht(w,E,x,!0):(U&8&&u(g,""),q&16&&S(F,g,_,E,x,$,O,T))},hs=(f,h,g,_,E,x,$,O,T)=>{f=f||Bt,h=h||Bt;let w=f.length,U=h.length,F=Math.min(w,U),j;for(j=0;j<F;j++){let q=h[j]=T?$t(h[j]):ct(h[j]);y(f[j],q,g,null,E,x,$,O,T)}w>U?ht(f,E,x,!0,!1,F):S(h,g,_,E,x,$,O,T,F)},Dn=(f,h,g,_,E,x,$,O,T)=>{let w=0,U=h.length,F=f.length-1,j=U-1;for(;w<=F&&w<=j;){let q=f[w],Q=h[w]=T?$t(h[w]):ct(h[w]);if(Xt(q,Q))y(q,Q,g,null,E,x,$,O,T);else break;w++}for(;w<=F&&w<=j;){let q=f[F],Q=h[j]=T?$t(h[j]):ct(h[j]);if(Xt(q,Q))y(q,Q,g,null,E,x,$,O,T);else break;F--,j--}if(w>F){if(w<=j){let q=j+1,Q=q<U?h[q].el:_;for(;w<=j;)y(null,h[w]=T?$t(h[w]):ct(h[w]),g,Q,E,x,$,O,T),w++}}else if(w>j)for(;w<=F;)Nt(f[w],E,x,!0),w++;else{let q=w,Q=w,ce=new Map;for(w=Q;w<=j;w++){let Ae=h[w]=T?$t(h[w]):ct(h[w]);Ae.key!=null&&ce.set(Ae.key,w)}let se,_e=0,et=j-Q+1,sn=!1,oi=0,In=new Array(et);for(w=0;w<et;w++)In[w]=0;for(w=q;w<=F;w++){let Ae=f[w];if(_e>=et){Nt(Ae,E,x,!0);continue}let rt;if(Ae.key!=null)rt=ce.get(Ae.key);else for(se=Q;se<=j;se++)if(In[se-Q]===0&&Xt(Ae,h[se])){rt=se;break}rt===void 0?Nt(Ae,E,x,!0):(In[rt-Q]=w+1,rt>=oi?oi=rt:sn=!0,y(Ae,h[rt],g,null,E,x,$,O,T),_e++)}let si=sn?vu(In):Bt;for(se=si.length-1,w=et-1;w>=0;w--){let Ae=Q+w,rt=h[Ae],ri=Ae+1<U?h[Ae+1].el:_;In[w]===0?y(null,rt,g,ri,E,x,$,O,T):sn&&(se<0||w!==si[se]?nn(rt,g,ri,2):se--)}}},nn=(f,h,g,_,E=null)=>{let{el:x,type:$,transition:O,children:T,shapeFlag:w}=f;if(w&6){nn(f.component.subTree,h,g,_);return}if(w&128){f.suspense.move(h,g,_);return}if(w&64){$.move(f,h,g,on);return}if($===ne){o(x,h,g);for(let F=0;F<T.length;F++)nn(T[F],h,g,_);o(f.anchor,h,g);return}if($===vn){B(f,h,g);return}if(_!==2&&w&1&&O)if(_===0)O.beforeEnter(x),o(x,h,g),Pe(()=>O.enter(x),E);else{let{leave:F,delayLeave:j,afterLeave:q}=O,Q=()=>o(x,h,g),ce=()=>{F(x,()=>{Q(),q&&q()})};j?j(x,Q,ce):ce()}else o(x,h,g)},Nt=(f,h,g,_=!1,E=!1)=>{let{type:x,props:$,ref:O,children:T,dynamicChildren:w,shapeFlag:U,patchFlag:F,dirs:j}=f;if(O!=null&&ar(O,null,g,f,!0),U&256){h.ctx.deactivate(f);return}let q=U&1&&j,Q=!Yn(f),ce;if(Q&&(ce=$&&$.onVnodeBeforeUnmount)&&lt(ce,h,f),U&6)Tl(f.component,g,_);else{if(U&128){f.suspense.unmount(g,_);return}q&&qt(f,null,h,"beforeUnmount"),U&64?f.type.remove(f,h,g,E,on,_):w&&(x!==ne||F>0&&F&64)?ht(w,h,g,!1,!0):(x===ne&&F&384||!E&&U&16)&&ht(T,h,g),_&&ti(f)}(Q&&(ce=$&&$.onVnodeUnmounted)||q)&&Pe(()=>{ce&&lt(ce,h,f),q&&qt(f,null,h,"unmounted")},g)},ti=f=>{let{type:h,el:g,anchor:_,transition:E}=f;if(h===ne){kl(g,_);return}if(h===vn){N(f);return}let x=()=>{s(g),E&&!E.persisted&&E.afterLeave&&E.afterLeave()};if(f.shapeFlag&1&&E&&!E.persisted){let{leave:$,delayLeave:O}=E,T=()=>$(g,x);O?O(f.el,x,T):T()}else x()},kl=(f,h)=>{let g;for(;f!==h;)g=p(f),s(f),f=g;s(h)},Tl=(f,h,g)=>{let{bum:_,scope:E,update:x,subTree:$,um:O}=f;_&&un(_),E.stop(),x&&(x.active=!1,Nt($,f,h,g)),O&&Pe(O,h),Pe(()=>{f.isUnmounted=!0},h),h&&h.pendingBranch&&!h.isUnmounted&&f.asyncDep&&!f.asyncResolved&&f.suspenseId===h.pendingId&&(h.deps--,h.deps===0&&h.resolve()),__VUE_PROD_DEVTOOLS__&&Mc(f)},ht=(f,h,g,_=!1,E=!1,x=0)=>{for(let $=x;$<f.length;$++)Nt(f[$],h,g,_,E)},fo=f=>f.shapeFlag&6?fo(f.component.subTree):f.shapeFlag&128?f.suspense.next():p(f.anchor||f.el),ni=(f,h,g)=>{f==null?h._vnode&&Nt(h._vnode,null,null,!0):y(h._vnode||null,f,h,null,null,null,g),Si(),Qi(),h._vnode=f},on={p:y,um:Nt,m:nn,r:ti,mt:Qe,mc:S,pc:pt,pbc:G,n:fo,o:e},ms,vs;return t&&([ms,vs]=t(on)),{render:ni,hydrate:ms,createApp:au(ni,ms)}}function Gt({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function mu(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Ea(e,t,n=!1){let o=e.children,s=t.children;if(L(o)&&L(s))for(let r=0;r<o.length;r++){let i=o[r],a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=$t(s[r]),a.el=i.el),n||Ea(i,a)),a.type===no&&(a.el=i.el)}}function vu(e){let t=e.slice(),n=[0],o,s,r,i,a,c=e.length;for(o=0;o<c;o++){let l=e[o];if(l!==0){if(s=n[n.length-1],e[s]<l){t[o]=s,n.push(o);continue}for(r=0,i=n.length-1;r<i;)a=r+i>>1,e[n[a]]<l?r=a+1:i=a;l<e[n[r]]&&(r>0&&(t[o]=n[r-1]),n[r]=o)}}for(r=n.length,i=n[r-1];r-- >0;)n[r]=i,i=t[i];return n}var gu=e=>e.__isTeleport;var ne=Symbol.for("v-fgt"),no=Symbol.for("v-txt"),He=Symbol.for("v-cmt"),vn=Symbol.for("v-stc"),Jn=[],nt=null;function D(e=!1){Jn.push(nt=e?null:[])}function yu(){Jn.pop(),nt=Jn[Jn.length-1]||null}var eo=1;function Bi(e){eo+=e}function wa(e){return e.dynamicChildren=eo>0?nt||Bt:null,yu(),eo>0&&nt&&nt.push(e),e}function R(e,t,n,o,s,r){return wa(M(e,t,n,o,s,r,!0))}function Ie(e,t,n,o,s){return wa(X(e,t,n,o,s,!0))}function Ho(e){return e?e.__v_isVNode===!0:!1}function Xt(e,t){return e.type===t.type&&e.key===t.key}var Zo="__vInternal",Na=({key:e})=>e??null,Fo=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?ue(e)||he(e)||W(e)?{i:we,r:e,k:t,f:!!n}:e:null);function M(e,t=null,n=null,o=0,s=null,r=e===ne?0:1,i=!1,a=!1){let c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Na(t),ref:t&&Fo(t),scopeId:sa,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:we};return a?(yr(c,n),r&128&&e.normalize(c)):n&&(c.shapeFlag|=ue(n)?8:16),eo>0&&!i&&nt&&(c.patchFlag>0||r&6)&&c.patchFlag!==32&&nt.push(c),c}var X=_u;function _u(e,t=null,n=null,o=0,s=null,r=!1){if((!e||e===ra)&&(e=He),Ho(e)){let a=Mt(e,t,!0);return n&&yr(a,n),eo>0&&!r&&nt&&(a.shapeFlag&6?nt[nt.indexOf(e)]=a:nt.push(a)),a.patchFlag|=-2,a}if(Su(e)&&(e=e.__vccOpts),t){t=bu(t);let{class:a,style:c}=t;a&&!ue(a)&&(t.class=ge(a)),oe(c)&&(Mo(c)&&!L(c)&&(c=pe({},c)),t.style=Re(c))}let i=ue(e)?1:Lc(e)?128:gu(e)?64:oe(e)?4:W(e)?2:0;return M(e,t,n,o,s,i,r,!0)}function bu(e){return e?Mo(e)||Zo in e?pe({},e):e:null}function Mt(e,t,n=!1){let{props:o,ref:s,patchFlag:r,children:i}=e,a=t?Eu(o||{},t):o;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Na(a),ref:t&&t.ref?n&&s?L(s)?s.concat(Fo(t)):[s,Fo(t)]:Fo(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ne?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Mt(e.ssContent),ssFallback:e.ssFallback&&Mt(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function gr(e=" ",t=0){return X(no,null,e,t)}function Oa(e,t){let n=X(vn,null,e);return n.staticCount=t,n}function st(e="",t=!1){return t?(D(),Ie(He,null,e)):X(He,null,e)}function ct(e){return e==null||typeof e=="boolean"?X(He):L(e)?X(ne,null,e.slice()):typeof e=="object"?$t(e):X(no,null,String(e))}function $t(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Mt(e)}function yr(e,t){let n=0,{shapeFlag:o}=e;if(t==null)t=null;else if(L(t))n=16;else if(typeof t=="object")if(o&65){let s=t.default;s&&(s._c&&(s._d=!1),yr(e,s()),s._c&&(s._d=!0));return}else{n=32;let s=t._;!s&&!(Zo in t)?t._ctx=we:s===3&&we&&(we.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else W(t)?(t={default:t,_ctx:we},n=32):(t=String(t),o&64?(n=16,t=[gr(t)]):n=8);e.children=t,e.shapeFlag|=n}function Eu(...e){let t={};for(let n=0;n<e.length;n++){let o=e[n];for(let s in o)if(s==="class")t.class!==o.class&&(t.class=ge([t.class,o.class]));else if(s==="style")t.style=Re([t.style,o.style]);else if(cn(s)){let r=t[s],i=o[s];i&&r!==i&&!(L(r)&&r.includes(i))&&(t[s]=r?[].concat(r,i):i)}else s!==""&&(t[s]=o[s])}return t}function lt(e,t,n,o=null){Le(e,t,7,[n,o])}var wu=ha(),Nu=0;function Ou(e,t,n){let o=e.type,s=(t?t.appContext:e.appContext)||wu,r={uid:Nu++,vnode:e,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Bn(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:va(o,s),emitsOptions:oa(o,s),emit:null,emitted:null,propsDefaults:ie,inheritAttrs:o.inheritAttrs,ctx:ie,data:ie,props:ie,attrs:ie,slots:ie,refs:ie,setupState:ie,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Ac.bind(null,r),e.ce&&e.ce(r),r}var be=null,_r=()=>be||we,br,hn,Ki="__VUE_INSTANCE_SETTERS__";(hn=fn()[Ki])||(hn=fn()[Ki]=[]),hn.push(e=>be=e),br=e=>{hn.length>1?hn.forEach(t=>t(e)):hn[0](e)};var _n=e=>{br(e),e.scope.on()},Qt=()=>{be&&be.scope.off(),br(null)};function Ca(e){return e.vnode.shapeFlag&4}var to=!1;function Cu(e,t=!1){to=t;let{props:n,children:o}=e.vnode,s=Ca(e);lu(e,n,s,t),du(e,o);let r=s?xu(e,t):void 0;return to=!1,r}function xu(e,t){var n;let o=e.type;e.accessCache=Object.create(null),e.proxy=Ue(new Proxy(e.ctx,eu));let{setup:s}=o;if(s){let r=e.setupContext=s.length>1?Tu(e):null;_n(e),Dt();let i=bt(s,e,0,[e.props,r]);if(It(),Qt(),Ts(i)){if(i.then(Qt,Qt),t)return i.then(a=>{Wi(e,a,t)}).catch(a=>{Bo(a,e,0)});e.asyncDep=i}else Wi(e,i,t)}else xa(e,t)}function Wi(e,t,n){W(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:oe(t)&&(__VUE_PROD_DEVTOOLS__&&(e.devtoolsRawSetupState=t),e.setupState=Po(t)),xa(e,n)}var zi,qi;function xa(e,t,n){let o=e.type;if(!e.render){if(!t&&zi&&!o.render){let s=o.template||mr(e).template;if(s){let{isCustomElement:r,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:c}=o,l=pe(pe({isCustomElement:r,delimiters:a},i),c);o.render=zi(s,l)}}e.render=o.render||Ve,qi&&qi(e)}if(__VUE_OPTIONS_API__){_n(e),Dt();try{tu(e)}finally{It(),Qt()}}}function ku(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,n){return Te(e,"get","$attrs"),t[n]}}))}function Tu(e){let t=n=>{e.exposed=n||{}};return{get attrs(){return ku(e)},slots:e.slots,emit:e.emit,expose:t}}function Qo(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Po(Ue(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Xn)return Xn[n](e)},has(t,n){return n in t||n in Xn}}))}var Du=/(?:^|[-_])(\w)/g,Iu=e=>e.replace(Du,t=>t.toUpperCase()).replace(/[-_]/g,"");function ka(e,t=!0){return W(e)?e.displayName||e.name:e.name||t&&e.__name}function Ta(e,t,n=!1){let o=ka(t);if(!o&&t.__file){let s=t.__file.match(/([^/\\]+)\.\w+$/);s&&(o=s[1])}if(!o&&e&&e.parent){let s=r=>{for(let i in r)if(r[i]===t)return i};o=s(e.components||e.parent.type.components)||s(e.appContext.components)}return o?Iu(o):n?"App":"Anonymous"}function Su(e){return W(e)&&"__vccOpts"in e}var z=(e,t)=>Ii(e,t,to);function es(e,t,n){let o=arguments.length;return o===2?oe(t)&&!L(t)?Ho(t)?X(e,null,[t]):X(e,t):X(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&Ho(n)&&(n=[n]),X(e,t,n))}var Vu=Symbol.for("v-scx"),$u=()=>{{let e=Zt(Vu);return e}};var Gi="3.3.8";var Mu="http://www.w3.org/2000/svg",tn=typeof document<"u"?document:null,Da=tn&&tn.createElement("template"),Pu={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{let t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{let s=t?tn.createElementNS(Mu,e):tn.createElement(e,n?{is:n}:void 0);return e==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:e=>tn.createTextNode(e),createComment:e=>tn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>tn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,o,s,r){let i=n?n.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{Da.innerHTML=o?`<svg>${e}</svg>`:e;let a=Da.content;if(o){let c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,n)}return[i?i.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Rt="transition",oo="animation",On=Symbol("_vtc"),Cn=(e,{slots:t})=>es(ca,za(e),t);Cn.displayName="Transition";var Wa={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Au=Cn.props=pe({},pr,Wa),en=(e,t=[])=>{L(e)?e.forEach(n=>n(...t)):e&&e(...t)},Ia=e=>e?L(e)?e.some(t=>t.length>1):e.length>1:!1;function za(e){let t={};for(let A in e)A in Wa||(t[A]=e[A]);if(e.css===!1)return t;let{name:n="v",type:o,duration:s,enterFromClass:r=`${n}-enter-from`,enterActiveClass:i=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=r,appearActiveClass:l=i,appearToClass:u=a,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=e,v=Ru(s),y=v&&v[0],k=v&&v[1],{onBeforeEnter:P,onEnter:V,onEnterCancelled:b,onLeave:B,onLeaveCancelled:N,onBeforeAppear:J=P,onAppear:C=V,onAppearCancelled:I=b}=t,S=(A,te,xe)=>{Ft(A,te?u:a),Ft(A,te?l:i),xe&&xe()},K=(A,te)=>{A._isLeaving=!1,Ft(A,d),Ft(A,m),Ft(A,p),te&&te()},G=A=>(te,xe)=>{let Qe=A?C:V,ve=()=>S(te,A,xe);en(Qe,[te,ve]),Sa(()=>{Ft(te,A?c:r),wt(te,A?u:a),Ia(Qe)||Va(te,o,y,ve)})};return pe(t,{onBeforeEnter(A){en(P,[A]),wt(A,r),wt(A,i)},onBeforeAppear(A){en(J,[A]),wt(A,c),wt(A,l)},onEnter:G(!1),onAppear:G(!0),onLeave(A,te){A._isLeaving=!0;let xe=()=>K(A,te);wt(A,d),Ga(),wt(A,p),Sa(()=>{A._isLeaving&&(Ft(A,d),wt(A,m),Ia(B)||Va(A,o,k,xe))}),en(B,[A,xe])},onEnterCancelled(A){S(A,!1),en(b,[A])},onAppearCancelled(A){S(A,!0),en(I,[A])},onLeaveCancelled(A){K(A),en(N,[A])}})}function Ru(e){if(e==null)return null;if(oe(e))return[Er(e.enter),Er(e.leave)];{let t=Er(e);return[t,t]}}function Er(e){return Ss(e)}function wt(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[On]||(e[On]=new Set)).add(t)}function Ft(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.remove(o));let n=e[On];n&&(n.delete(t),n.size||(e[On]=void 0))}function Sa(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}var Fu=0;function Va(e,t,n,o){let s=e._endId=++Fu,r=()=>{s===e._endId&&o()};if(n)return setTimeout(r,n);let{type:i,timeout:a,propCount:c}=qa(e,t);if(!i)return o();let l=i+"end",u=0,d=()=>{e.removeEventListener(l,p),r()},p=m=>{m.target===e&&++u>=c&&d()};setTimeout(()=>{u<c&&d()},a+1),e.addEventListener(l,p)}function qa(e,t){let n=window.getComputedStyle(e),o=v=>(n[v]||"").split(", "),s=o(`${Rt}Delay`),r=o(`${Rt}Duration`),i=$a(s,r),a=o(`${oo}Delay`),c=o(`${oo}Duration`),l=$a(a,c),u=null,d=0,p=0;t===Rt?i>0&&(u=Rt,d=i,p=r.length):t===oo?l>0&&(u=oo,d=l,p=c.length):(d=Math.max(i,l),u=d>0?i>l?Rt:oo:null,p=u?u===Rt?r.length:c.length:0);let m=u===Rt&&/\b(transform|all)(,|$)/.test(o(`${Rt}Property`).toString());return{type:u,timeout:d,propCount:p,hasTransform:m}}function $a(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,o)=>Ma(n)+Ma(e[o])))}function Ma(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function Ga(){return document.body.offsetHeight}function Uu(e,t,n){let o=e[On];o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}var xr=Symbol("_vod"),kr={beforeMount(e,{value:t},{transition:n}){e[xr]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):so(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:o}){!t!=!n&&(o?t?(o.beforeEnter(e),so(e,!0),o.enter(e)):o.leave(e,()=>{so(e,!1)}):so(e,t))},beforeUnmount(e,{value:t}){so(e,t)}};function so(e,t){e.style.display=t?e[xr]:"none"}function ju(e,t,n){let o=e.style,s=ue(n);if(n&&!s){if(t&&!ue(t))for(let r in t)n[r]==null&&Cr(o,r,"");for(let r in n)Cr(o,r,n[r])}else{let r=o.display;s?t!==n&&(o.cssText=n):t&&e.removeAttribute("style"),xr in e&&(o.display=r)}}var Pa=/\s*!important$/;function Cr(e,t,n){if(L(n))n.forEach(o=>Cr(e,t,o));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{let o=Lu(e,t);Pa.test(n)?e.setProperty(vt(o),n.replace(Pa,""),"important"):e[o]=n}}var Aa=["Webkit","Moz","ms"],wr={};function Lu(e,t){let n=wr[t];if(n)return n;let o=$e(t);if(o!=="filter"&&o in e)return wr[t]=o;o=Kt(o);for(let s=0;s<Aa.length;s++){let r=Aa[s]+o;if(r in e)return wr[t]=r}return t}var Ra="http://www.w3.org/1999/xlink";function Hu(e,t,n,o,s){if(o&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(Ra,t.slice(6,t.length)):e.setAttributeNS(Ra,t,n);else{let r=di(t);n==null||r&&!Vs(n)?e.removeAttribute(t):e.setAttribute(t,r?"":n)}}function Bu(e,t,n,o,s,r,i){if(t==="innerHTML"||t==="textContent"){o&&i(o,s,r),e[t]=n??"";return}let a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){e._value=n;let l=a==="OPTION"?e.getAttribute("value"):e.value,u=n??"";l!==u&&(e.value=u),n==null&&e.removeAttribute(t);return}let c=!1;if(n===""||n==null){let l=typeof e[t];l==="boolean"?n=Vs(n):n==null&&l==="string"?(n="",c=!0):l==="number"&&(n=0,c=!0)}try{e[t]=n}catch{}c&&e.removeAttribute(t)}function Nn(e,t,n,o){e.addEventListener(t,n,o)}function Ku(e,t,n,o){e.removeEventListener(t,n,o)}var Fa=Symbol("_vei");function Wu(e,t,n,o,s=null){let r=e[Fa]||(e[Fa]={}),i=r[t];if(o&&i)i.value=o;else{let[a,c]=zu(t);if(o){let l=r[t]=Yu(o,s);Nn(e,a,l,c)}else i&&(Ku(e,a,i,c),r[t]=void 0)}}var Ua=/(?:Once|Passive|Capture)$/;function zu(e){let t;if(Ua.test(e)){t={};let o;for(;o=e.match(Ua);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):vt(e.slice(2)),t]}var Nr=0,qu=Promise.resolve(),Gu=()=>Nr||(qu.then(()=>Nr=0),Nr=Date.now());function Yu(e,t){let n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;Le(Xu(o,n.value),t,5,[o])};return n.value=e,n.attached=Gu(),n}function Xu(e,t){if(L(t)){let n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(o=>s=>!s._stopped&&o&&o(s))}else return t}var ja=/^on[a-z]/,Ju=(e,t,n,o,s=!1,r,i,a,c)=>{t==="class"?Uu(e,o,s):t==="style"?ju(e,n,o):cn(t)?Rn(t)||Wu(e,t,n,o,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Zu(e,t,o,s))?Bu(e,t,o,r,i,a,c):(t==="true-value"?e._trueValue=o:t==="false-value"&&(e._falseValue=o),Hu(e,t,o,s))};function Zu(e,t,n,o){return o?!!(t==="innerHTML"||t==="textContent"||t in e&&ja.test(t)&&W(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||ja.test(t)&&ue(n)?!1:t in e}var Ya=new WeakMap,Xa=new WeakMap,ts=Symbol("_moveCb"),La=Symbol("_enterCb"),Ja={name:"TransitionGroup",props:pe({},Au,{tag:String,moveClass:String}),setup(e,{slots:t}){let n=_r(),o=fr(),s,r;return wn(()=>{if(!s.length)return;let i=e.moveClass||`${e.name||"v"}-move`;if(!od(s[0].el,n.vnode.el,i))return;s.forEach(ed),s.forEach(td);let a=s.filter(nd);Ga(),a.forEach(c=>{let l=c.el,u=l.style;wt(l,i),u.transform=u.webkitTransform=u.transitionDuration="";let d=l[ts]=p=>{p&&p.target!==l||(!p||/transform$/.test(p.propertyName))&&(l.removeEventListener("transitionend",d),l[ts]=null,Ft(l,i))};l.addEventListener("transitionend",d)})}),()=>{let i=Y(e),a=za(i),c=i.tag||ne;s=r,r=t.default?qo(t.default()):[];for(let l=0;l<r.length;l++){let u=r[l];u.key!=null&&yn(u,gn(u,a,o,n))}if(s)for(let l=0;l<s.length;l++){let u=s[l];yn(u,gn(u,a,o,n)),Ya.set(u,u.el.getBoundingClientRect())}return X(c,null,r)}}},Qu=e=>delete e.mode;Ja.props;var Za=Ja;function ed(e){let t=e.el;t[ts]&&t[ts](),t[La]&&t[La]()}function td(e){Xa.set(e,e.el.getBoundingClientRect())}function nd(e){let t=Ya.get(e),n=Xa.get(e),o=t.left-n.left,s=t.top-n.top;if(o||s){let r=e.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",e}}function od(e,t,n){let o=e.cloneNode(),s=e[On];s&&s.forEach(a=>{a.split(/\s+/).forEach(c=>c&&o.classList.remove(c))}),n.split(/\s+/).forEach(a=>a&&o.classList.add(a)),o.style.display="none";let r=t.nodeType===1?t:t.parentNode;r.appendChild(o);let{hasTransform:i}=qa(o);return r.removeChild(o),i}var Ha=e=>{let t=e.props["onUpdate:modelValue"]||!1;return L(t)?n=>un(t,n):t};function sd(e){e.target.composing=!0}function Ba(e){let t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}var Or=Symbol("_assign"),xn={created(e,{modifiers:{lazy:t,trim:n,number:o}},s){e[Or]=Ha(s);let r=o||s.props&&s.props.type==="number";Nn(e,t?"change":"input",i=>{if(i.target.composing)return;let a=e.value;n&&(a=a.trim()),r&&(a=Ln(a)),e[Or](a)}),n&&Nn(e,"change",()=>{e.value=e.value.trim()}),t||(Nn(e,"compositionstart",sd),Nn(e,"compositionend",Ba),Nn(e,"change",Ba))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:o,number:s}},r){if(e[Or]=Ha(r),e.composing||document.activeElement===e&&e.type!=="range"&&(n||o&&e.value.trim()===t||(s||e.type==="number")&&Ln(e.value)===t))return;let i=t??"";e.value!==i&&(e.value=i)}};var rd=["ctrl","shift","alt","meta"],id={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>rd.some(n=>e[`${n}Key`]&&!t.includes(n))},Ke=(e,t)=>(n,...o)=>{for(let s=0;s<t.length;s++){let r=id[t[s]];if(r&&r(n,t))return}return e(n,...o)},ad={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ut=(e,t)=>n=>{if(!("key"in n))return;let o=vt(n.key);if(t.some(s=>s===o||ad[s]===o))return e(n)},ld=pe({patchProp:Ju},Pu),Ka;function cd(){return Ka||(Ka=ba(ld))}var Qa=(...e)=>{let t=cd().createApp(...e),{mount:n}=t;return t.mount=o=>{let s=ud(o);if(!s)return;let r=t._component;!W(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.innerHTML="";let i=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function ud(e){return ue(e)?document.querySelector(e):e}function dd(e){return e.position}function fd(e,t,n){e.position.x=t,e.position.y=n}var Tr=null;function sl(e){Tr=e}function Je(){if(!Tr)throw new Error("providePlugin() must be called before usePlugin()");return{viewModel:Tr}}function Ze(){let{viewModel:e}=Je();return{graph:yt(e.value,"displayedGraph"),switchGraph:e.value.switchGraph}}function Lr(e){let{graph:t}=Ze(),n=H(null),o=H(null);return{dragging:z(()=>!!n.value),onPointerDown:c=>{n.value={x:c.pageX,y:c.pageY},o.value={x:e.value.x,y:e.value.y}},onPointerMove:c=>{if(n.value){let l=c.pageX-n.value.x,u=c.pageY-n.value.y;e.value.x=o.value.x+l/t.value.scaling,e.value.y=o.value.y+u/t.value.scaling}},onPointerUp:()=>{n.value=null,o.value=null}}}function rl(){let{graph:e}=Ze();return{transform:(n,o)=>{let s=n/e.value.scaling-e.value.panning.x,r=o/e.value.scaling-e.value.panning.y;return[s,r]}}}function pd(){let{graph:e}=Ze(),t=[],n=-1,o={x:0,y:0},s=z(()=>e.value.panning),r=Lr(s),i=z(()=>({"transform-origin":"0 0",transform:`scale(${e.value.scaling}) translate(${e.value.panning.x}px, ${e.value.panning.y}px)`})),a=(m,v,y)=>{let k=[m/e.value.scaling-e.value.panning.x,v/e.value.scaling-e.value.panning.y],P=[m/y-e.value.panning.x,v/y-e.value.panning.y],V=[P[0]-k[0],P[1]-k[1]];e.value.panning.x+=V[0],e.value.panning.y+=V[1],e.value.scaling=y},c=m=>{m.preventDefault();let v=m.deltaY;m.deltaMode===1&&(v*=32);let y=e.value.scaling*(1-v/3e3);a(m.offsetX,m.offsetY,y)},l=()=>({ax:t[0].clientX,ay:t[0].clientY,bx:t[1].clientX,by:t[1].clientY});return{styles:i,...r,onPointerDown:m=>{if(t.push(m),r.onPointerDown(m),t.length===2){let{ax:v,ay:y,bx:k,by:P}=l();o={x:v+(k-v)/2,y:y+(P-y)/2}}},onPointerMove:m=>{for(let v=0;v<t.length;v++)if(m.pointerId==t[v].pointerId){t[v]=m;break}if(t.length==2){let{ax:v,ay:y,bx:k,by:P}=l(),V=v-k,b=y-P,B=Math.sqrt(V*V+b*b);if(n>0){let N=e.value.scaling*(1+(B-n)/500);a(o.x,o.y,N)}n=B}else r.onPointerMove(m)},onPointerUp:m=>{t=t.filter(v=>v.pointerId!==m.pointerId),n=-1,r.onPointerUp()},onMouseWheel:c}}var Xe=(e=>(e[e.NONE=0]="NONE",e[e.ALLOWED=1]="ALLOWED",e[e.FORBIDDEN=2]="FORBIDDEN",e))(Xe||{}),il=Symbol();function hd(){let{graph:e}=Ze(),t=H(null),n=H(null),o=a=>{t.value&&(t.value.mx=a.offsetX/e.value.scaling-e.value.panning.x,t.value.my=a.offsetY/e.value.scaling-e.value.panning.y)},s=()=>{if(n.value){if(t.value)return;let a=e.value.connections.find(c=>c.to===n.value);n.value.isInput&&a?(t.value={status:Xe.NONE,from:a.from},e.value.removeConnection(a)):t.value={status:Xe.NONE,from:n.value},t.value.mx=void 0,t.value.my=void 0}},r=()=>{if(t.value&&n.value){if(t.value.from===n.value)return;e.value.addConnection(t.value.from,t.value.to)}t.value=null},i=a=>{if(n.value=a??null,a&&t.value){t.value.to=a;let c=e.value.checkConnection(t.value.from,t.value.to);if(t.value.status=c.connectionAllowed?Xe.ALLOWED:Xe.FORBIDDEN,c.connectionAllowed){let l=c.connectionsInDanger.map(u=>u.id);e.value.connections.forEach(u=>{l.includes(u.id)&&(u.isInDanger=!0)})}}else!a&&t.value&&(t.value.to=void 0,t.value.status=Xe.NONE,e.value.connections.forEach(c=>{c.isInDanger=!1}))};return Jo(il,{temporaryConnection:t,hoveredOver:i}),{temporaryConnection:t,onMouseMove:o,onMouseDown:s,onMouseUp:r,hoveredOver:i}}var md=de({setup(){let{viewModel:e}=Je(),{graph:t}=Ze();return{styles:z(()=>{let o=e.value.settings.background,s=t.value.panning.x*t.value.scaling,r=t.value.panning.y*t.value.scaling,i=t.value.scaling*o.gridSize,a=i/o.gridDivision,c=`${i}px ${i}px, ${i}px ${i}px`,l=t.value.scaling>o.subGridVisibleThreshold?`, ${a}px ${a}px, ${a}px ${a}px`:"";return{backgroundPosition:`left ${s}px top ${r}px`,backgroundSize:`${c} ${l}`}})}}}),ae=(e,t)=>{let n=e.__vccOpts||e;for(let[o,s]of t)n[o]=s;return n};function vd(e,t,n,o,s,r){return D(),R("div",{class:"background",style:Re(e.styles)},null,4)}var gd=ae(md,[["render",vd]]);function yd(e){return Wn()?(Ls(e),!0):!1}function Hr(e){return typeof e=="function"?e():je(e)}var al=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;var _d=Object.prototype.toString,bd=e=>_d.call(e)==="[object Object]",Dr=()=>{},Ed=wd();function wd(){var e;return al&&((e=window?.navigator)==null?void 0:e.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}function Nd(e,t,n=!1){return t.reduce((o,s)=>(s in e&&(!n||e[s]!==void 0)&&(o[s]=e[s]),o),{})}function Od(e,t={}){if(!he(e))return Js(e);let n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(let o in e.value)n[o]=Xs(()=>({get(){return e.value[o]},set(s){var r;if((r=Hr(t.replaceRef))!=null?r:!0)if(Array.isArray(e.value)){let a=[...e.value];a[o]=s,e.value=a}else{let a={...e.value,[o]:s};Object.setPrototypeOf(a,Object.getPrototypeOf(e.value)),e.value=a}else e.value[o]=s}}));return n}function ro(e){var t;let n=Hr(e);return(t=n?.$el)!=null?t:n}var Br=al?window:void 0;function io(...e){let t,n,o,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,o,s]=e,t=Br):[t,n,o,s]=e,!t)return Dr;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);let r=[],i=()=>{r.forEach(u=>u()),r.length=0},a=(u,d,p,m)=>(u.addEventListener(d,p,m),()=>u.removeEventListener(d,p,m)),c=ft(()=>[ro(t),Hr(s)],([u,d])=>{if(i(),!u)return;let p=bd(d)?{...d}:d;r.push(...n.flatMap(m=>o.map(v=>a(u,m,v,p))))},{immediate:!0,flush:"post"}),l=()=>{c(),i()};return yd(l),l}var el=!1;function Ir(e,t,n={}){let{window:o=Br,ignore:s=[],capture:r=!0,detectIframe:i=!1}=n;if(!o)return;Ed&&!el&&(el=!0,Array.from(o.document.body.children).forEach(p=>p.addEventListener("click",Dr)),o.document.documentElement.addEventListener("click",Dr));let a=!0,c=p=>s.some(m=>{if(typeof m=="string")return Array.from(o.document.querySelectorAll(m)).some(v=>v===p.target||p.composedPath().includes(v));{let v=ro(m);return v&&(p.target===v||p.composedPath().includes(v))}}),u=[io(o,"click",p=>{let m=ro(e);if(!(!m||m===p.target||p.composedPath().includes(m))){if(p.detail===0&&(a=!c(p)),!a){a=!0;return}t(p)}},{passive:!0,capture:r}),io(o,"pointerdown",p=>{let m=ro(e);a=!c(p)&&!!(m&&!p.composedPath().includes(m))},{passive:!0}),i&&io(o,"blur",p=>{setTimeout(()=>{var m;let v=ro(e);((m=o.document.activeElement)==null?void 0:m.tagName)==="IFRAME"&&!v?.contains(o.document.activeElement)&&t(p)},0)})].filter(Boolean);return()=>u.forEach(p=>p())}var ll={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},Cd=Object.keys(ll);function xd(e={}){let{target:t=Br}=e,n=H(!1),o=H(e.initialValue||{});Object.assign(o.value,ll,o.value);let s=r=>{n.value=!0,!(e.pointerTypes&&!e.pointerTypes.includes(r.pointerType))&&(o.value=Nd(r,Cd,!1))};if(t){let r={passive:!0};io(t,["pointerdown","pointermove","pointerup"],s,r),io(t,"pointerleave",()=>n.value=!1,r)}return{...Od(o),isInside:n}}var kd=de({props:{modelValue:{type:Boolean,default:!1},items:{type:Array,required:!0},x:{type:Number,default:0},y:{type:Number,default:0},isNested:{type:Boolean,default:!1},isFlipped:{type:Object,default:()=>({x:!1,y:!1})},flippable:{type:Boolean,default:!1}},emits:["click","update:modelValue"],setup(e,{emit:t}){let n=null,o=H(null),s=H(-1),r=H(0),i=H({x:!1,y:!1}),a=z(()=>e.flippable&&(i.value.x||e.isFlipped.x)),c=z(()=>e.flippable&&(i.value.y||e.isFlipped.y)),l=z(()=>{let k={};return e.isNested||(k.top=(c.value?e.y-r.value:e.y)+"px",k.left=e.x+"px"),k}),u=z(()=>({"--flipped-x":a.value,"--flipped-y":c.value,"--nested":e.isNested})),d=z(()=>e.items.map(k=>({...k,hover:!1})));return ft([()=>e.y,()=>e.items],()=>{var k,P,V,b;r.value=e.items.length*30;let B=((P=(k=o.value)==null?void 0:k.parentElement)==null?void 0:P.offsetWidth)??0,N=((b=(V=o.value)==null?void 0:V.parentElement)==null?void 0:b.offsetHeight)??0;i.value.x=!e.isNested&&e.x>B*.75,i.value.y=!e.isNested&&e.y+r.value>N-20}),Ir(o,()=>{e.modelValue&&t("update:modelValue",!1)}),{el:o,activeMenu:s,flippedX:a,flippedY:c,styles:l,classes:u,itemsWithHoverProperty:d,onClick:k=>{!k.submenu&&k.value&&(t("click",k.value),t("update:modelValue",!1))},onChildClick:k=>{t("click",k),s.value=-1,e.isNested||t("update:modelValue",!1)},onClickOutside:Ir,onMouseEnter:(k,P)=>{e.items[P].submenu&&(s.value=P,n!==null&&(clearTimeout(n),n=null))},onMouseLeave:(k,P)=>{e.items[P].submenu&&(n=window.setTimeout(()=>{s.value=-1,n=null},200))}}}}),Td=["onMouseenter","onMouseleave","onClick"],Dd={class:"flex-fill"},Id={key:0,class:"__submenu-icon",style:{"line-height":"1em"}},Sd=M("svg",{width:"13",height:"13",viewBox:"-60 120 250 250"},[M("path",{d:"M160.875 279.5625 L70.875 369.5625 L70.875 189.5625 L160.875 279.5625 Z",stroke:"none",fill:"white"})],-1),Vd=[Sd];function $d(e,t,n,o,s,r){let i=ot("context-menu",!0);return D(),Ie(Cn,{name:"slide-fade"},{default:En(()=>[Pt(M("div",{ref:"el",class:ge(["baklava-context-menu",e.classes]),style:Re(e.styles)},[(D(!0),R(ne,null,Ye(e.itemsWithHoverProperty,(a,c)=>(D(),R(ne,null,[a.isDivider?(D(),R("div",{key:`d-${c}`,class:"divider"})):(D(),R("div",{key:`i-${c}`,class:ge(["item",{submenu:!!a.submenu,"--disabled":!!a.disabled}]),onMouseenter:l=>e.onMouseEnter(l,c),onMouseleave:l=>e.onMouseLeave(l,c),onClick:Ke(l=>e.onClick(a),["stop","prevent"])},[M("div",Dd,ye(a.label),1),a.submenu?(D(),R("div",Id,Vd)):st("",!0),a.submenu?(D(),Ie(i,{key:1,value:e.activeMenu===c,items:a.submenu,"is-nested":!0,"is-flipped":{x:e.flippedX,y:e.flippedY},flippable:e.flippable,onClick:e.onChildClick},null,8,["value","items","is-flipped","flippable","onClick"])):st("",!0)],42,Td))],64))),256))],6),[[kr,e.modelValue]])]),_:1})}var Kr=ae(kd,[["render",$d]]),Md={},Pd={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"16",height:"16",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Ad=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Rd=M("circle",{cx:"12",cy:"12",r:"1"},null,-1),Fd=M("circle",{cx:"12",cy:"19",r:"1"},null,-1),Ud=M("circle",{cx:"12",cy:"5",r:"1"},null,-1),jd=[Ad,Rd,Fd,Ud];function Ld(e,t){return D(),R("svg",Pd,jd)}var cl=ae(Md,[["render",Ld]]),Hd=["id"],Bd={key:2,class:"align-middle"},Sr=de({__name:"NodeInterface",props:{node:{},intf:{}},setup(e){let t=e,{viewModel:n}=Je(),{hoveredOver:o,temporaryConnection:s}=Zt(il),r=H(null),i=z(()=>t.intf.connectionCount>0),a=z(()=>({"--input":t.intf.isInput,"--output":!t.intf.isInput,"--connected":i.value})),c=z(()=>t.intf.component&&(!t.intf.isInput||!t.intf.port||t.intf.connectionCount===0)),l=()=>{o(t.intf)},u=()=>{o(void 0)},d=()=>{r.value&&n.value.hooks.renderInterface.execute({intf:t.intf,el:r.value})},p=()=>{let m=n.value.displayedGraph.sidebar;m.nodeId=t.node.id,m.optionName=t.intf.name,m.visible=!0};return At(d),wn(d),(m,v)=>{var y;return D(),R("div",{id:m.intf.id,ref_key:"el",ref:r,class:ge(["baklava-node-interface",a.value])},[m.intf.port?(D(),R("div",{key:0,class:ge(["__port",{"--selected":((y=je(s))==null?void 0:y.from)===m.intf}]),onPointerover:l,onPointerout:u},null,34)):st("",!0),c.value?(D(),Ie(zo(m.intf.component),{key:1,modelValue:m.intf.value,"onUpdate:modelValue":v[0]||(v[0]=k=>m.intf.value=k),node:m.node,intf:m.intf,onOpenSidebar:p},null,40,["modelValue","node","intf"])):(D(),R("span",Bd,ye(m.intf.name),1))],10,Hd)}}}),Kd=["id","data-node-type"],Wd=["onPointerdown"],zd={class:"__title-label"},qd={class:"__menu"},Gd=["onKeydown"],Yd={class:"__outputs"},Xd={class:"__inputs"},ul=de({__name:"Node",props:{node:{},selected:{type:Boolean,default:!1}},emits:["select"],setup(e,{emit:t}){let n=e,o=t,{viewModel:s}=Je(),{graph:r,switchGraph:i}=Ze(),a=Lr(yt(n.node,"position")),c=H(null),l=H(!1),u=H(""),d=H(null),p=H(!1),m=z(()=>{let S=[{value:"rename",label:"Rename"},{value:"delete",label:"Delete"}];return n.node.type.startsWith(Lt)&&S.push({value:"editSubgraph",label:"Edit Subgraph"}),S}),v=z(()=>({"--selected":n.selected,"--dragging":a.dragging.value,"--two-column":!!n.node.twoColumn})),y=z(()=>{var S,K;return{top:`${((S=n.node.position)==null?void 0:S.y)??0}px`,left:`${((K=n.node.position)==null?void 0:K.x)??0}px`,width:`${n.node.width??200}px`}}),k=z(()=>Object.values(n.node.inputs).filter(S=>!S.hidden)),P=z(()=>Object.values(n.node.outputs).filter(S=>!S.hidden)),V=()=>{o("select")},b=S=>{a.onPointerDown(S),document.addEventListener("pointermove",a.onPointerMove),document.addEventListener("pointerup",B),V()},B=()=>{a.onPointerUp(),document.removeEventListener("pointermove",a.onPointerMove),document.removeEventListener("pointerup",B)},N=()=>{p.value=!0},J=async S=>{var K;switch(S){case"delete":r.value.removeNode(n.node);break;case"rename":u.value=n.node.title,l.value=!0,await bn(),(K=d.value)==null||K.focus();break;case"editSubgraph":i(n.node.template);break}},C=()=>{n.node.title=u.value,l.value=!1},I=()=>{c.value&&s.value.hooks.renderNode.execute({node:n.node,el:c.value})};return At(I),wn(I),(S,K)=>(D(),R("div",{id:S.node.id,ref_key:"el",ref:c,class:ge(["baklava-node",v.value]),style:Re(y.value),"data-node-type":S.node.type,onPointerdown:V},[Be(S.$slots,"title",{},()=>[M("div",{class:"__title",onPointerdown:Ke(b,["self","stop"])},[l.value?Pt((D(),R("input",{key:1,ref_key:"renameInputEl",ref:d,"onUpdate:modelValue":K[1]||(K[1]=G=>u.value=G),type:"text",class:"baklava-input",placeholder:"Node Name",onBlur:C,onKeydown:[Ut(C,["enter"]),K[2]||(K[2]=Ut(Ke(()=>{},["stop"]),["delete"]))]},null,40,Gd)),[[xn,u.value]]):(D(),R(ne,{key:0},[M("div",zd,ye(S.node.title),1),M("div",qd,[X(cl,{class:"--clickable",onClick:N}),X(Kr,{modelValue:p.value,"onUpdate:modelValue":K[0]||(K[0]=G=>p.value=G),x:0,y:0,items:m.value,onClick:J},null,8,["modelValue","items"])])],64))],40,Wd)]),Be(S.$slots,"content",{},()=>[M("div",{class:"__content",onKeydown:K[3]||(K[3]=Ut(Ke(()=>{},["stop"]),["delete"]))},[M("div",Yd,[(D(!0),R(ne,null,Ye(P.value,G=>Be(S.$slots,"nodeInterface",{key:G.id,type:"output",node:S.node,intf:G},()=>[X(Sr,{node:S.node,intf:G},null,8,["node","intf"])])),128))]),M("div",Xd,[(D(!0),R(ne,null,Ye(k.value,G=>Be(S.$slots,"nodeInterface",{key:G.id,type:"input",node:S.node,intf:G},()=>[X(Sr,{node:S.node,intf:G},null,8,["node","intf"])])),128))])],32)])],46,Kd))}}),Jd=de({props:{x1:{type:Number,required:!0},y1:{type:Number,required:!0},x2:{type:Number,required:!0},y2:{type:Number,required:!0},state:{type:Number,default:Xe.NONE},isTemporary:{type:Boolean,default:!1}},setup(e){let{viewModel:t}=Je(),{graph:n}=Ze(),o=(i,a)=>{let c=(i+n.value.panning.x)*n.value.scaling,l=(a+n.value.panning.y)*n.value.scaling;return[c,l]},s=z(()=>{let[i,a]=o(e.x1,e.y1),[c,l]=o(e.x2,e.y2);if(t.value.settings.useStraightConnections)return`M ${i} ${a} L ${c} ${l}`;{let u=.3*Math.abs(i-c);return`M ${i} ${a} C ${i+u} ${a}, ${c-u} ${l}, ${c} ${l}`}}),r=z(()=>({"--temporary":e.isTemporary,"--allowed":e.state===Xe.ALLOWED,"--forbidden":e.state===Xe.FORBIDDEN}));return{d:s,classes:r}}}),Zd=["d"];function Qd(e,t,n,o,s,r){return D(),R("path",{class:ge(["baklava-connection",e.classes]),d:e.d},null,10,Zd)}var Wr=ae(Jd,[["render",Qd]]);function ef(e){return document.getElementById(e.id)}function kn(e){let t=document.getElementById(e.id),n=t?.getElementsByClassName("__port");return{node:t?.closest(".baklava-node")??null,interface:t,port:n&&n.length>0?n[0]:null}}var tf=de({components:{"connection-view":Wr},props:{connection:{type:Object,required:!0}},setup(e){let{graph:t}=Ze(),n,o=H({x1:0,y1:0,x2:0,y2:0}),s=z(()=>e.connection.isInDanger?Xe.FORBIDDEN:Xe.NONE),r=z(()=>{var l;return(l=t.value.findNodeById(e.connection.from.nodeId))==null?void 0:l.position}),i=z(()=>{var l;return(l=t.value.findNodeById(e.connection.to.nodeId))==null?void 0:l.position}),a=l=>l.node&&l.interface&&l.port?[l.node.offsetLeft+l.interface.offsetLeft+l.port.offsetLeft+l.port.clientWidth/2,l.node.offsetTop+l.interface.offsetTop+l.port.offsetTop+l.port.clientHeight/2]:[0,0],c=()=>{let l=kn(e.connection.from),u=kn(e.connection.to);l.node&&u.node&&(n||(n=new ResizeObserver(()=>{c()}),n.observe(l.node),n.observe(u.node)));let[d,p]=a(l),[m,v]=a(u);o.value={x1:d,y1:p,x2:m,y2:v}};return At(async()=>{await bn(),c()}),Xo(()=>{n&&n.disconnect()}),ft([r,i],()=>c(),{deep:!0}),{d:o,state:s}}});function nf(e,t,n,o,s,r){let i=ot("connection-view");return D(),Ie(i,{x1:e.d.x1,y1:e.d.y1,x2:e.d.x2,y2:e.d.y2,state:e.state},null,8,["x1","y1","x2","y2","state"])}var dl=ae(tf,[["render",nf]]);function os(e){return e.node&&e.interface&&e.port?[e.node.offsetLeft+e.interface.offsetLeft+e.port.offsetLeft+e.port.clientWidth/2,e.node.offsetTop+e.interface.offsetTop+e.port.offsetTop+e.port.clientHeight/2]:[0,0]}var of=de({components:{"connection-view":Wr},props:{connection:{type:Object,required:!0}},setup(e){let t=z(()=>e.connection?e.connection.status:Xe.NONE);return{d:z(()=>{if(!e.connection)return{input:[0,0],output:[0,0]};let o=os(kn(e.connection.from)),s=e.connection.to?os(kn(e.connection.to)):[e.connection.mx||o[0],e.connection.my||o[1]];return e.connection.from.isInput?{input:s,output:o}:{input:o,output:s}}),status:t}}});function sf(e,t,n,o,s,r){let i=ot("connection-view");return D(),Ie(i,{x1:e.d.input[0],y1:e.d.input[1],x2:e.d.output[0],y2:e.d.output[1],state:e.status,"is-temporary":""},null,8,["x1","y1","x2","y2","state"])}var fl=ae(of,[["render",sf]]),rf=de({setup(){let{viewModel:e}=Je(),{graph:t}=Ze(),n=H(null),o=yt(e.value.settings.sidebar,"width"),s=z(()=>e.value.settings.sidebar.resizable),r=z(()=>{let d=t.value.sidebar.nodeId;return t.value.nodes.find(p=>p.id===d)}),i=z(()=>({width:`${o.value}px`})),a=z(()=>r.value?[...Object.values(r.value.inputs),...Object.values(r.value.outputs)].filter(p=>p.displayInSidebar&&p.component):[]),c=()=>{t.value.sidebar.visible=!1},l=()=>{window.addEventListener("mousemove",u),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",u)},{once:!0})},u=d=>{var p,m;let v=((m=(p=n.value)==null?void 0:p.parentElement)==null?void 0:m.getBoundingClientRect().width)??500,y=o.value-d.movementX;y<300?y=300:y>.9*v&&(y=.9*v),o.value=y};return{el:n,graph:t,resizable:s,node:r,styles:i,displayedInterfaces:a,startResize:l,close:c}}}),af={class:"__header"},lf={class:"__node-name"};function cf(e,t,n,o,s,r){return D(),R("div",{ref:"el",class:ge(["baklava-sidebar",{"--open":e.graph.sidebar.visible}]),style:Re(e.styles),onKeydown:t[2]||(t[2]=Ut(Ke(()=>{},["stop"]),["delete"]))},[e.resizable?(D(),R("div",{key:0,class:"__resizer",onMousedown:t[0]||(t[0]=(...i)=>e.startResize&&e.startResize(...i))},null,32)):st("",!0),M("div",af,[M("button",{tabindex:"-1",class:"__close",onClick:t[1]||(t[1]=(...i)=>e.close&&e.close(...i))},"\xD7"),M("div",lf,[M("b",null,ye(e.node?e.node.title:""),1)])]),(D(!0),R(ne,null,Ye(e.displayedInterfaces,i=>(D(),R("div",{key:i.id,class:"__interface"},[(D(),Ie(zo(i.component),{modelValue:i.value,"onUpdate:modelValue":a=>i.value=a,node:e.node,intf:i},null,8,["modelValue","onUpdate:modelValue","node","intf"]))]))),128))],38)}var pl=ae(rf,[["render",cf]]),uf=de({setup(){let{viewModel:e}=Je(),{graph:t}=Ze(),n=H(null),o=H(!1),s,r=!1,i={x1:0,y1:0,x2:0,y2:0},a=()=>{var V,b;if(!s)return;let B=new Map,N=new Map;for(let I of t.value.nodes){let S=ef(I),K=S?.clientWidth??0,G=S?.clientHeight??0,A=((V=I.position)==null?void 0:V.x)??0,te=((b=I.position)==null?void 0:b.y)??0;B.set(I,{x1:A,y1:te,x2:A+K,y2:te+G}),N.set(I,S)}let J={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};for(let I of B.values())I.x1<J.x1&&(J.x1=I.x1),I.y1<J.y1&&(J.y1=I.y1),I.x2>J.x2&&(J.x2=I.x2),I.y2>J.y2&&(J.y2=I.y2);let C=50;J.x1-=C,J.y1-=C,J.x2+=C,J.y2+=C,i=J,s.clearRect(0,0,s.canvas.width,s.canvas.height),s.strokeStyle="white";for(let I of t.value.connections){let[S,K]=os(kn(I.from)),[G,A]=os(kn(I.to)),[te,xe]=c(S,K),[Qe,ve]=c(G,A);if(s.beginPath(),s.moveTo(te,xe),e.value.settings.useStraightConnections)s.lineTo(Qe,ve);else{let le=.3*Math.abs(te-Qe);s.bezierCurveTo(te+le,xe,Qe-le,ve,Qe,ve)}s.stroke()}s.strokeStyle="lightgray";for(let[I,S]of B.entries()){let[K,G]=c(S.x1,S.y1),[A,te]=c(S.x2,S.y2);s.fillStyle=u(N.get(I)),s.beginPath(),s.rect(K,G,A-K,te-G),s.fill(),s.stroke()}if(o.value){let I=p(),[S,K]=c(I.x1,I.y1),[G,A]=c(I.x2,I.y2);s.fillStyle="rgba(255, 255, 255, 0.2)",s.fillRect(S,K,G-S,A-K)}},c=(V,b)=>[(V-i.x1)/(i.x2-i.x1)*s.canvas.clientWidth,(b-i.y1)/(i.y2-i.y1)*s.canvas.clientHeight],l=(V,b)=>[V*(i.x2-i.x1)/s.canvas.clientWidth+i.x1,b*(i.y2-i.y1)/s.canvas.clientHeight+i.y1],u=V=>{if(V){let b=V.querySelector(".__content");if(b){let N=d(b);if(N)return N}let B=d(V);if(B)return B}return"gray"},d=V=>{let b=getComputedStyle(V).backgroundColor;if(b&&b!=="rgba(0, 0, 0, 0)")return b},p=()=>{let V=n.value.parentElement.offsetWidth,b=n.value.parentElement.offsetHeight,B=V/t.value.scaling-t.value.panning.x,N=b/t.value.scaling-t.value.panning.y;return{x1:-t.value.panning.x,y1:-t.value.panning.y,x2:B,y2:N}},m=V=>{V.button===0&&(r=!0,v(V))},v=V=>{if(r){let[b,B]=l(V.offsetX,V.offsetY),N=p(),J=(N.x1-N.x2)/2,C=(N.y1-N.y2)/2;t.value.panning.x=-(b+J),t.value.panning.y=-(B+C)}},y=()=>{r=!1},k=()=>{o.value=!0},P=()=>{o.value=!1,y()};return At(()=>{s=n.value.getContext("2d"),s.imageSmoothingQuality="high",a()}),{canvas:n,showViewBounds:o,mousedown:m,mousemove:v,mouseup:y,mouseenter:k,mouseleave:P}}});function df(e,t,n,o,s,r){return D(),R("canvas",{ref:"canvas",class:"baklava-minimap",onMouseenter:t[0]||(t[0]=(...i)=>e.mouseenter&&e.mouseenter(...i)),onMouseleave:t[1]||(t[1]=(...i)=>e.mouseleave&&e.mouseleave(...i)),onMousedown:t[2]||(t[2]=Ke((...i)=>e.mousedown&&e.mousedown(...i),["self"])),onMousemove:t[3]||(t[3]=Ke((...i)=>e.mousemove&&e.mousemove(...i),["self"])),onMouseup:t[4]||(t[4]=(...i)=>e.mouseup&&e.mouseup(...i))},null,544)}var hl=ae(uf,[["render",df]]),ff=de({components:{ContextMenu:Kr,VerticalDots:cl},props:{type:{type:String,required:!0},title:{type:String,required:!0}},setup(e){let{viewModel:t}=Je(),{switchGraph:n}=Ze(),o=H(!1),s=z(()=>e.type.startsWith(Lt));return{showContextMenu:o,hasContextMenu:s,contextMenuItems:[{label:"Edit Subgraph",value:"editSubgraph"},{label:"Delete Subgraph",value:"deleteSubgraph"}],openContextMenu:()=>{o.value=!0},onContextMenuClick:c=>{let l=e.type.substring(Lt.length),u=t.value.editor.graphTemplates.find(d=>d.id===l);if(u)switch(c){case"editSubgraph":n(u);break;case"deleteSubgraph":t.value.editor.removeGraphTemplate(u);break}}}}}),pf=["data-node-type"],hf={class:"__title"},mf={class:"__title-label"},vf={key:0,class:"__menu"};function gf(e,t,n,o,s,r){let i=ot("vertical-dots"),a=ot("context-menu");return D(),R("div",{class:"baklava-node --palette","data-node-type":e.type},[M("div",hf,[M("div",mf,ye(e.title),1),e.hasContextMenu?(D(),R("div",vf,[X(i,{class:"--clickable",onPointerdown:t[0]||(t[0]=Ke(()=>{},["stop","prevent"])),onClick:Ke(e.openContextMenu,["stop","prevent"])},null,8,["onClick"]),X(a,{modelValue:e.showContextMenu,"onUpdate:modelValue":t[1]||(t[1]=c=>e.showContextMenu=c),x:-100,y:0,items:e.contextMenuItems,onClick:e.onContextMenuClick,onPointerdown:t[2]||(t[2]=Ke(()=>{},["stop","prevent"]))},null,8,["modelValue","items","onClick"])])):st("",!0)])],8,pf)}var yf=ae(ff,[["render",gf]]),ns,_f=new Uint8Array(16);function bf(){if(!ns&&(ns=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ns))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ns(_f)}var Ne=[];for(let e=0;e<256;++e)Ne.push((e+256).toString(16).slice(1));function Ef(e,t=0){return Ne[e[t+0]]+Ne[e[t+1]]+Ne[e[t+2]]+Ne[e[t+3]]+"-"+Ne[e[t+4]]+Ne[e[t+5]]+"-"+Ne[e[t+6]]+Ne[e[t+7]]+"-"+Ne[e[t+8]]+Ne[e[t+9]]+"-"+Ne[e[t+10]]+Ne[e[t+11]]+Ne[e[t+12]]+Ne[e[t+13]]+Ne[e[t+14]]+Ne[e[t+15]]}var wf=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tl={randomUUID:wf};function ss(e,t,n){if(tl.randomUUID&&!t&&!e)return tl.randomUUID();e=e||{};let o=e.random||(e.rng||bf)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){n=n||0;for(let s=0;s<16;++s)t[n+s]=o[s];return t}return Ef(o)}var Nf=de({props:{intf:{type:Object,required:!0}},setup(e){return{onClick:()=>{e.intf.callback&&e.intf.callback()}}}}),Of=["title"];function Cf(e,t,n,o,s,r){return D(),R("button",{class:"baklava-button --block",title:e.intf.name,onClick:t[0]||(t[0]=(...i)=>e.onClick&&e.onClick(...i))},ye(e.intf.name),9,Of)}var ml=ae(Nf,[["render",Cf]]),Vr=class extends Oe{constructor(t,n){super(t,void 0),this.component=Ue(ml),this.callback=n,this.setPort(!1)}},xf=["title"],kf=M("div",{class:"__checkmark-container"},[M("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18"},[M("path",{class:"__checkmark",d:"M 6 5 L 6 10 L 16 10",transform:"rotate(-45 10 10)"})])],-1),Tf={class:"__label"},vl=de({__name:"CheckboxInterface",props:{modelValue:{type:Boolean},intf:{}},emits:["update:modelValue"],setup(e,{emit:t}){let n=t;return(o,s)=>(D(),R("div",{class:ge(["baklava-checkbox",{"--checked":o.modelValue}]),title:o.intf.name,onClick:s[0]||(s[0]=r=>n("update:modelValue",!o.modelValue))},[kf,M("div",Tf,ye(o.intf.name),1)],10,xf))}}),$r=class extends Oe{constructor(){super(...arguments),this.component=Ue(vl)}},nl=9;function Df(e){return"validate"in e}var ao=class extends Oe{constructor(t,n,o,s){super(t,n),this.min=o,this.max=s}validate(t){return(!this.min||t>=this.min)&&(!this.max||t<=this.max)}},zr=(e,t=3)=>{let n=H(null),o=H(!1),s=H(!1),r=H("0"),i=z(()=>{let d=e.value.value.toFixed(t);return d.length>nl?e.value.value.toExponential(nl-5):d}),a=d=>Number.isNaN(d)?!1:Df(e.value)?e.value.validate(d):!0,c=d=>{a(d)&&(e.value.value=d)};return ft(r,()=>{s.value=!1}),{editMode:o,invalid:s,tempValue:r,inputEl:n,stringRepresentation:i,validate:a,setValue:c,enterEditMode:async()=>{r.value=e.value.value.toFixed(t),o.value=!0,await bn(),n.value&&n.value.focus()},leaveEditMode:()=>{let d=parseFloat(r.value);a(d)?(c(d),o.value=!1):s.value=!0}}},If={},Sf={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Vf=M("polyline",{points:"6 9 12 15 18 9"},null,-1),$f=[Vf];function Mf(e,t){return D(),R("svg",Sf,$f)}var qr=ae(If,[["render",Mf]]),Pf=de({components:{"i-arrow":qr},props:{intf:{type:Object,required:!0}},setup(e){let t=zr(yt(e,"intf"),0);return{...t,increment:()=>{t.setValue(e.intf.value+1)},decrement:()=>{t.setValue(e.intf.value-1)}}}}),Af={class:"baklava-num-input"},Rf=["title"],Ff={class:"__value"},Uf={key:1,class:"__content"};function jf(e,t,n,o,s,r){let i=ot("i-arrow");return D(),R("div",Af,[M("div",{class:"__button --dec",onClick:t[0]||(t[0]=(...a)=>e.decrement&&e.decrement(...a))},[X(i)]),e.editMode?(D(),R("div",Uf,[Pt(M("input",{ref:"inputEl","onUpdate:modelValue":t[2]||(t[2]=a=>e.tempValue=a),type:"number",class:ge(["baklava-input",{"--invalid":e.invalid}]),style:{"text-align":"right"},onBlur:t[3]||(t[3]=(...a)=>e.leaveEditMode&&e.leaveEditMode(...a)),onKeydown:t[4]||(t[4]=Ut((...a)=>e.leaveEditMode&&e.leaveEditMode(...a),["enter"]))},null,34),[[xn,e.tempValue]])])):(D(),R("div",{key:0,class:"__content",onClick:t[1]||(t[1]=(...a)=>e.enterEditMode&&e.enterEditMode(...a))},[M("div",{class:"__label",title:e.intf.name},ye(e.intf.name),9,Rf),M("div",Ff,ye(e.stringRepresentation),1)])),M("div",{class:"__button --inc",onClick:t[5]||(t[5]=(...a)=>e.increment&&e.increment(...a))},[X(i)])])}var gl=ae(Pf,[["render",jf]]),Mr=class extends ao{constructor(){super(...arguments),this.component=Ue(gl)}validate(t){return Number.isInteger(t)&&super.validate(t)}},Lf=de({components:{"i-arrow":qr},props:{intf:{type:Object,required:!0}},setup(e){let t=zr(yt(e,"intf"));return{...t,increment:()=>{t.setValue(e.intf.value+.1)},decrement:()=>{t.setValue(e.intf.value-.1)}}}}),Hf={class:"baklava-num-input"},Bf=["title"],Kf={class:"__value"},Wf={key:1,class:"__content"};function zf(e,t,n,o,s,r){let i=ot("i-arrow");return D(),R("div",Hf,[M("div",{class:"__button --dec",onClick:t[0]||(t[0]=(...a)=>e.decrement&&e.decrement(...a))},[X(i)]),e.editMode?(D(),R("div",Wf,[Pt(M("input",{ref:"inputEl","onUpdate:modelValue":t[2]||(t[2]=a=>e.tempValue=a),type:"number",class:ge(["baklava-input",{"--invalid":e.invalid}]),style:{"text-align":"right"},onBlur:t[3]||(t[3]=(...a)=>e.leaveEditMode&&e.leaveEditMode(...a)),onKeydown:t[4]||(t[4]=Ut((...a)=>e.leaveEditMode&&e.leaveEditMode(...a),["enter"]))},null,34),[[xn,e.tempValue]])])):(D(),R("div",{key:0,class:"__content",onClick:t[1]||(t[1]=(...a)=>e.enterEditMode&&e.enterEditMode(...a))},[M("div",{class:"__label",title:e.intf.name},ye(e.intf.name),9,Bf),M("div",Kf,ye(e.stringRepresentation),1)])),M("div",{class:"__button --inc",onClick:t[5]||(t[5]=(...a)=>e.increment&&e.increment(...a))},[X(i)])])}var yl=ae(Lf,[["render",zf]]),Pr=class extends ao{constructor(){super(...arguments),this.component=Ue(yl)}},qf=de({components:{"i-arrow":qr},props:{intf:{type:Object,required:!0}},setup(e){let t=H(null),n=H(!1),o=z(()=>e.intf.items.find(i=>typeof i=="string"?i===e.intf.value:i.value===e.intf.value)),s=z(()=>o.value?typeof o.value=="string"?o.value:o.value.text:""),r=i=>{e.intf.value=typeof i=="string"?i:i.value};return Ir(t,()=>{n.value=!1}),{el:t,open:n,selectedItem:o,selectedText:s,setSelected:r}}}),Gf=["title"],Yf={class:"__selected"},Xf={class:"__text"},Jf={class:"__icon"},Zf={class:"__dropdown"},Qf={class:"item --header"},ep=["onClick"];function tp(e,t,n,o,s,r){let i=ot("i-arrow");return D(),R("div",{ref:"el",class:ge(["baklava-select",{"--open":e.open}]),title:e.intf.name,onClick:t[0]||(t[0]=a=>e.open=!e.open)},[M("div",Yf,[M("div",Xf,ye(e.selectedText),1),M("div",Jf,[X(i)])]),X(Cn,{name:"slide-fade"},{default:En(()=>[Pt(M("div",Zf,[M("div",Qf,ye(e.intf.name),1),(D(!0),R(ne,null,Ye(e.intf.items,(a,c)=>(D(),R("div",{key:c,class:ge(["item",{"--active":a===e.selectedItem}]),onClick:l=>e.setSelected(a)},ye(typeof a=="string"?a:a.text),11,ep))),128))],512),[[kr,e.open]])]),_:1})],10,Gf)}var _l=ae(qf,[["render",tp]]),Ar=class extends Oe{constructor(t,n,o){super(t,n),this.component=Ue(_l),this.items=o}},np=de({props:{intf:{type:Object,required:!0}},setup(e){let t=H(null),n=zr(yt(e,"intf")),o=H(!1),s=H(!1),r=z(()=>Math.min(100,Math.max(0,(e.intf.value-e.intf.min)*100/(e.intf.max-e.intf.min))));return{...n,el:t,percentage:r,mousedown:()=>{n.editMode.value||(s.value=!0)},mouseup:()=>{n.editMode.value||(o.value||n.enterEditMode(),s.value=!1,o.value=!1)},mousemove:u=>{if(n.editMode.value)return;let d=Math.max(e.intf.min,Math.min(e.intf.max,(e.intf.max-e.intf.min)*(u.offsetX/t.value.clientWidth)+e.intf.min));s.value&&(n.setValue(d),o.value=!0)},mouseleave:u=>{n.editMode.value||(s.value&&(u.offsetX>=t.value.clientWidth?n.setValue(e.intf.max):u.offsetX<=0&&n.setValue(e.intf.min)),s.value=!1,o.value=!1)}}}}),op={key:0,class:"__content"},sp={class:"__label"},rp={class:"__value"},ip={key:1,class:"__content"};function ap(e,t,n,o,s,r){return D(),R("div",{ref:"el",class:ge(["baklava-slider",{"baklava-ignore-mouse":!e.editMode}]),onPointerdown:t[3]||(t[3]=(...i)=>e.mousedown&&e.mousedown(...i)),onPointerup:t[4]||(t[4]=(...i)=>e.mouseup&&e.mouseup(...i)),onPointermove:t[5]||(t[5]=(...i)=>e.mousemove&&e.mousemove(...i)),onPointerleave:t[6]||(t[6]=(...i)=>e.mouseleave&&e.mouseleave(...i))},[M("div",{class:"__slider",style:Re({width:e.percentage+"%"})},null,4),e.editMode?(D(),R("div",ip,[Pt(M("input",{ref:"inputEl","onUpdate:modelValue":t[0]||(t[0]=i=>e.tempValue=i),type:"number",class:ge(["baklava-input",{"--invalid":e.invalid}]),style:{"text-align":"right"},onBlur:t[1]||(t[1]=(...i)=>e.leaveEditMode&&e.leaveEditMode(...i)),onKeydown:t[2]||(t[2]=Ut((...i)=>e.leaveEditMode&&e.leaveEditMode(...i),["enter"]))},null,34),[[xn,e.tempValue]])])):(D(),R("div",op,[M("div",sp,ye(e.intf.name),1),M("div",rp,ye(e.stringRepresentation),1)]))],34)}var bl=ae(np,[["render",ap]]),Rr=class extends ao{constructor(t,n,o,s){super(t,n,o,s),this.component=Ue(bl),this.min=o,this.max=s}},lp=de({props:{intf:{type:Object,required:!0}}});function cp(e,t,n,o,s,r){return D(),R("div",null,ye(e.intf.value),1)}var up=ae(lp,[["render",cp]]),Fr=class extends Oe{constructor(t,n){super(t,n),this.component=Ue(up),this.setPort(!1)}},dp=de({props:{intf:{type:Object,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){return{v:z({get:()=>e.modelValue,set:o=>{t("update:modelValue",o)}})}}}),fp=["placeholder","title"];function pp(e,t,n,o,s,r){return D(),R("div",null,[Pt(M("textarea",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.v=i),type:"text",class:"baklava-input",placeholder:e.intf.name,title:e.intf.name},null,8,fp),[[xn,e.v]])])}var El=ae(dp,[["render",pp]]),lo=class extends Oe{constructor(){super(...arguments),this.component=Ue(El)}},fs="__baklava_SubgraphInputNode",ps="__baklava_SubgraphOutputNode",rs=class extends mt{constructor(){super(),this.graphInterfaceId=ss()}onPlaced(){super.onPlaced(),this.initializeIo()}save(){return{...super.save(),graphInterfaceId:this.graphInterfaceId}}load(t){super.load(t),this.graphInterfaceId=t.graphInterfaceId}},co=class extends rs{constructor(){super(...arguments),this.type=fs,this._title="Subgraph Input",this.inputs={name:new lo("Name","Input").setPort(!1)},this.outputs={placeholder:new Oe("Connection","")}}},uo=class extends rs{constructor(){super(...arguments),this.type=ps,this._title="Subgraph Output",this.inputs={name:new lo("Name","Output").setPort(!1),placeholder:new Oe("Connection","")},this.outputs={}}};function wl(e,t,n){if(!t.template)return!1;if(it(t.template)===n)return!0;let o=e.graphTemplates.find(r=>it(r)===n);return o?o.nodes.filter(r=>r.type.startsWith(Lt)).some(r=>wl(e,t,r.type)):!1}var hp=de({components:{PaletteEntry:yf},setup(){let{viewModel:e}=Je(),{x:t,y:n}=xd(),{transform:o}=rl(),s=Zt("editorEl"),r=H(null),i=z(()=>{let l=Array.from(e.value.editor.nodeTypes.entries()),u=new Set(l.map(([,p])=>p.category)),d=[];for(let p of u.values()){let m=l.filter(([,v])=>v.category===p);e.value.displayedGraph.template?m=m.filter(([v])=>!wl(e.value.editor,e.value.displayedGraph,v)):m=m.filter(([v])=>![fs,ps].includes(v)),m.length>0&&d.push({name:p,nodeTypes:Object.fromEntries(m)})}return d.sort((p,m)=>p.name==="default"?-1:m.name==="default"||p.name>m.name?1:-1),d}),a=z(()=>{if(!r.value||!s?.value)return{};let{left:l,top:u}=s.value.getBoundingClientRect();return{top:`${n.value-u}px`,left:`${t.value-l}px`}});return{draggedNode:r,categories:i,draggedNodeStyles:a,onDragStart:(l,u)=>{r.value={type:l,nodeInformation:u};let d=()=>{let p=Me(new u.type);e.value.displayedGraph.addNode(p);let m=s.value.getBoundingClientRect(),[v,y]=o(t.value-m.left,n.value-m.top);p.position.x=v,p.position.y=y,r.value=null,document.removeEventListener("pointerup",d)};document.addEventListener("pointerup",d)},mouseX:t,mouseY:n}}}),mp={class:"baklava-node-palette"},vp={key:0};function gp(e,t,n,o,s,r){let i=ot("PaletteEntry");return D(),R(ne,null,[M("div",mp,[(D(!0),R(ne,null,Ye(e.categories,a=>(D(),R("section",{key:a.name},[a.name!=="default"?(D(),R("h1",vp,ye(a.name),1)):st("",!0),(D(!0),R(ne,null,Ye(a.nodeTypes,(c,l)=>(D(),Ie(i,{key:l,type:l,title:c.title,onPointerdown:u=>e.onDragStart(l,c)},null,8,["type","title","onPointerdown"]))),128))]))),128))]),X(Cn,{name:"fade"},{default:En(()=>[e.draggedNode?(D(),R("div",{key:0,class:"baklava-dragged-node",style:Re(e.draggedNodeStyles)},[X(i,{type:e.draggedNode.type,title:e.draggedNode.nodeInformation.title},null,8,["type","title"])],4)):st("",!0)]),_:1})],64)}var Nl=ae(hp,[["render",gp]]),Tn="SAVE_SUBGRAPH";function yp(e,t){let n=()=>{let o=e.value;if(!o.template)throw new Error("Graph template property not set");let s=[],r=[],i=o.nodes.filter(u=>u.type===fs);for(let u of i){let d=o.connections.filter(p=>p.from===u.outputs.placeholder);d.forEach(p=>{r.push({id:u.graphInterfaceId,name:u.inputs.name.value,nodeInterfaceId:p.to.id})}),s.push(...d)}let a=[],c=o.nodes.filter(u=>u.type===ps);for(let u of c){let d=o.connections.filter(p=>p.to===u.inputs.placeholder);d.forEach(p=>{a.push({id:u.graphInterfaceId,name:u.inputs.name.value,nodeInterfaceId:p.from.id})}),s.push(...d)}let l=o.connections.filter(u=>!s.includes(u));o.template.update({inputs:r,outputs:a,connections:l.map(u=>({id:u.id,from:u.from.id,to:u.to.id})),nodes:o.nodes.map(u=>u.save()),panning:o.panning,scaling:o.scaling}),o.template.panning=o.panning,o.template.scaling=o.scaling};t.registerCommand(Tn,{canExecute:()=>{var o;return e.value!==((o=e.value.editor)==null?void 0:o.graph)},execute:n})}var Gr="CREATE_SUBGRAPH",ol=[fs,ps];function _p(e,t,n){let o=()=>e.value.selectedNodes.filter(r=>!ol.includes(r.type)).length>0,s=()=>{let r=e.value,i=e.value.editor;if(r.selectedNodes.length===0)return;let a=r.selectedNodes.filter(C=>!ol.includes(C.type)),c=a.flatMap(C=>Object.values(C.inputs)),l=a.flatMap(C=>Object.values(C.outputs)),u=r.connections.filter(C=>!l.includes(C.from)&&c.includes(C.to)),d=r.connections.filter(C=>l.includes(C.from)&&!c.includes(C.to)),p=r.connections.filter(C=>l.includes(C.from)&&c.includes(C.to)),m=u.map(C=>C.to),v=d.map(C=>C.from),y=new Map,k=[];for(let C of m){let I=ss();y.set(C.id,I),k.push({id:I,nodeInterfaceId:C.id,name:C.name})}let P=[];for(let C of v){let I=ss();y.set(C.id,I),P.push({id:I,nodeInterfaceId:C.id,name:C.name})}let V=Me(new Ht({connections:p.map(C=>({id:C.id,from:C.from.id,to:C.to.id})),inputs:k,outputs:P,nodes:a.map(C=>C.save())},i));i.addGraphTemplate(V);let b=i.nodeTypes.get(it(V));if(!b)throw new Error("Unable to create subgraph: Could not find corresponding graph node type");let B=Me(new b.type);r.addNode(B);let N=Math.round(a.map(C=>C.position.x).reduce((C,I)=>C+I,0)/a.length),J=Math.round(a.map(C=>C.position.y).reduce((C,I)=>C+I,0)/a.length);B.position.x=N,B.position.y=J,u.forEach(C=>{r.removeConnection(C),r.addConnection(C.from,B.inputs[y.get(C.to.id)])}),d.forEach(C=>{r.removeConnection(C),r.addConnection(B.outputs[y.get(C.from.id)],C.to)}),a.forEach(C=>r.removeNode(C)),t.canExecuteCommand(Tn)&&t.executeCommand(Tn),n(V),e.value.panning={...r.panning},e.value.scaling=r.scaling};t.registerCommand(Gr,{canExecute:o,execute:s})}var Ur="DELETE_NODES";function bp(e,t){t.registerCommand(Ur,{canExecute:()=>e.value.selectedNodes.length>0,execute(){e.value.selectedNodes.forEach(n=>e.value.removeNode(n))}}),t.registerHotkey(["Delete"],Ur)}var Yr="SWITCH_TO_MAIN_GRAPH";function Ep(e,t,n){t.registerCommand(Yr,{canExecute:()=>e.value!==e.value.editor.graph,execute:()=>{t.executeCommand(Tn),n(e.value.editor.graph)}})}function wp(e,t,n){bp(e,t),_p(e,t,n),yp(e,t),Ep(e,t,n)}var is=class{constructor(t,n){this.type=t,t==="addNode"?this.nodeId=n:this.nodeState=n}undo(t){this.type==="addNode"?this.removeNode(t):this.addNode(t)}redo(t){this.type==="addNode"&&this.nodeState?this.addNode(t):this.type==="removeNode"&&this.nodeId&&this.removeNode(t)}addNode(t){let n=t.editor.nodeTypes.get(this.nodeState.type);if(!n)return;let o=new n.type;t.addNode(o),o.load(this.nodeState),this.nodeId=o.id}removeNode(t){let n=t.nodes.find(o=>o.id===this.nodeId);n&&(this.nodeState=n.save(),t.removeNode(n))}},as=class{constructor(t,n){if(this.type=t,t==="addConnection")this.connectionId=n;else{let o=n;this.connectionState={id:o.id,from:o.from.id,to:o.to.id}}}undo(t){this.type==="addConnection"?this.removeConnection(t):this.addConnection(t)}redo(t){this.type==="addConnection"&&this.connectionState?this.addConnection(t):this.type==="removeConnection"&&this.connectionId&&this.removeConnection(t)}addConnection(t){let n=t.findNodeInterface(this.connectionState.from),o=t.findNodeInterface(this.connectionState.to);!n||!o||t.addConnection(n,o)}removeConnection(t){let n=t.connections.find(o=>o.id===this.connectionId);n&&(this.connectionState={id:n.id,from:n.from.id,to:n.to.id},t.removeConnection(n))}},jr=class{constructor(t){if(this.type="transaction",t.length===0)throw new Error("Can't create a transaction with no steps");this.steps=t}undo(t){for(let n=this.steps.length-1;n>=0;n--)this.steps[n].undo(t)}redo(t){for(let n=0;n<this.steps.length;n++)this.steps[n].redo(t)}},ls="UNDO",cs="REDO",Xr="START_TRANSACTION",Jr="COMMIT_TRANSACTION";function Np(e,t){let n=Symbol("HistoryToken"),o=H(200),s=H([]),r=H(!1),i=H(-1),a=H(!1),c=H([]),l=k=>{if(!r.value)if(a.value)c.value.push(k);else for(i.value!==s.value.length-1&&(s.value=s.value.slice(0,i.value+1)),s.value.push(k),i.value++;s.value.length>o.value;)s.value.shift()},u=()=>{a.value=!0},d=()=>{a.value=!1,c.value.length>0&&(l(new jr(c.value)),c.value=[])},p=()=>s.value.length!==0&&i.value!==-1,m=()=>{p()&&(r.value=!0,s.value[i.value--].undo(e.value),r.value=!1)},v=()=>s.value.length!==0&&i.value<s.value.length-1,y=()=>{v()&&(r.value=!0,s.value[++i.value].redo(e.value),r.value=!1)};return ft(e,(k,P)=>{P&&(P.events.addNode.unsubscribe(n),P.events.removeNode.unsubscribe(n),P.events.addConnection.unsubscribe(n),P.events.removeConnection.unsubscribe(n)),k&&(k.events.addNode.subscribe(n,V=>{l(new is("addNode",V.id))}),k.events.removeNode.subscribe(n,V=>{l(new is("removeNode",V.save()))}),k.events.addConnection.subscribe(n,V=>{l(new as("addConnection",V.id))}),k.events.removeConnection.subscribe(n,V=>{l(new as("removeConnection",V))}))},{immediate:!0}),t.registerCommand(ls,{canExecute:p,execute:m}),t.registerCommand(cs,{canExecute:v,execute:y}),t.registerCommand(Xr,{canExecute:()=>!a.value,execute:u}),t.registerCommand(Jr,{canExecute:()=>a.value,execute:d}),t.registerHotkey(["Control","z"],ls),t.registerHotkey(["Control","y"],cs),Me({maxSteps:o})}var us="COPY",ds="PASTE",Ol="CLEAR_CLIPBOARD";function Op(e,t,n){let o=Symbol("ClipboardToken"),s=H(""),r=H(""),i=z(()=>!s.value),a=()=>{s.value="",r.value=""},c=()=>{let d=e.value.selectedNodes.flatMap(m=>[...Object.values(m.inputs),...Object.values(m.outputs)]),p=e.value.connections.filter(m=>d.includes(m.from)||d.includes(m.to)).map(m=>({from:m.from.id,to:m.to.id}));r.value=JSON.stringify(p),s.value=JSON.stringify(e.value.selectedNodes.map(m=>m.save()))},l=(d,p,m)=>{for(let v of d){let y;if((!m||m==="input")&&(y=Object.values(v.inputs).find(k=>k.id===p)),!y&&(!m||m==="output")&&(y=Object.values(v.outputs).find(k=>k.id===p)),y)return y}},u=()=>{if(i.value)return;let d=new Map,p=JSON.parse(s.value),m=JSON.parse(r.value),v=[],y=[],k=e.value;n.executeCommand(Xr);for(let P of p){let V=t.value.nodeTypes.get(P.type);if(!V){console.warn(`Node type ${P.type} not registered`);return}let b=new V.type,B=b.id;v.push(b);let N=J=>{Object.values(J).forEach(C=>{C.hooks.load.subscribe(o,I=>{let S=ss();return d.set(I.id,S),C.id=S,C.hooks.load.unsubscribe(o),I})})};N(b.inputs),N(b.outputs),b.hooks.beforeLoad.subscribe(o,J=>{let C=J;return C.position&&(C.position.x+=10,C.position.y+=10),b.hooks.beforeLoad.unsubscribe(o),C}),k.addNode(b),b.load(P),b.id=B,d.set(P.id,B)}for(let P of m){let V=l(v,d.get(P.from),"output"),b=l(v,d.get(P.to),"input");if(!V||!b)continue;let B=k.addConnection(V,b);B&&y.push(B)}return n.executeCommand(Jr),{newNodes:v,newConnections:y}};return n.registerCommand(us,{canExecute:()=>!0,execute:c}),n.registerHotkey(["Control","c"],us),n.registerCommand(ds,{canExecute:()=>!i.value,execute:u}),n.registerHotkey(["Control","v"],ds),n.registerCommand(Ol,{canExecute:()=>!0,execute:a}),Me({isEmpty:i})}var Cl="OPEN_SIDEBAR";function Cp(e,t){t.registerCommand(Cl,{execute:n=>{e.value.sidebar.nodeId=n,e.value.sidebar.visible=!0},canExecute:()=>!0})}function xp(e,t){Cp(e,t)}var kp=Object.freeze(Object.defineProperty({__proto__:null,CLEAR_CLIPBOARD_COMMAND:Ol,COMMIT_TRANSACTION_COMMAND:Jr,COPY_COMMAND:us,CREATE_SUBGRAPH_COMMAND:Gr,DELETE_NODES_COMMAND:Ur,OPEN_SIDEBAR_COMMAND:Cl,PASTE_COMMAND:ds,REDO_COMMAND:cs,SAVE_SUBGRAPH_COMMAND:Tn,START_TRANSACTION_COMMAND:Xr,SWITCH_TO_MAIN_GRAPH_COMMAND:Yr,UNDO_COMMAND:ls},Symbol.toStringTag,{value:"Module"})),Tp={},Dp={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Ip=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Sp=M("path",{d:"M9 13l-4 -4l4 -4m-4 4h11a4 4 0 0 1 0 8h-1"},null,-1),Vp=[Ip,Sp];function $p(e,t){return D(),R("svg",Dp,Vp)}var Mp=ae(Tp,[["render",$p]]),Pp={},Ap={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Rp=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Fp=M("path",{d:"M15 13l4 -4l-4 -4m4 4h-11a4 4 0 0 0 0 8h1"},null,-1),Up=[Rp,Fp];function jp(e,t){return D(),R("svg",Ap,Up)}var Lp=ae(Pp,[["render",jp]]),Hp={},Bp={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Kp=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Wp=M("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1),zp=M("line",{x1:"5",y1:"12",x2:"11",y2:"18"},null,-1),qp=M("line",{x1:"5",y1:"12",x2:"11",y2:"6"},null,-1),Gp=[Kp,Wp,zp,qp];function Yp(e,t){return D(),R("svg",Bp,Gp)}var Xp=ae(Hp,[["render",Yp]]),Jp={},Zp={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Qp=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),eh=M("path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"},null,-1),th=M("rect",{x:"9",y:"3",width:"6",height:"4",rx:"2"},null,-1),nh=[Qp,eh,th];function oh(e,t){return D(),R("svg",Zp,nh)}var sh=ae(Jp,[["render",oh]]),rh={},ih={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},ah=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),lh=M("rect",{x:"8",y:"8",width:"12",height:"12",rx:"2"},null,-1),ch=M("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"},null,-1),uh=[ah,lh,ch];function dh(e,t){return D(),R("svg",ih,uh)}var fh=ae(rh,[["render",dh]]),ph={},hh={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},mh=M("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),vh=M("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"},null,-1),gh=M("circle",{cx:"12",cy:"14",r:"2"},null,-1),yh=M("polyline",{points:"14 4 14 8 8 8 8 4"},null,-1),_h=[mh,vh,gh,yh];function bh(e,t){return D(),R("svg",hh,_h)}var Eh=ae(ph,[["render",bh]]),wh={},Nh={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Oh=Oa('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 3h4v4h-4z"></path><path d="M3 17h4v4h-4z"></path><path d="M17 17h4v4h-4z"></path><path d="M7 17l5 -4l5 4"></path><line x1="12" y1="7" x2="12" y2="13"></line>',6),Ch=[Oh];function xh(e,t){return D(),R("svg",Nh,Ch)}var kh=ae(wh,[["render",xh]]),Th=de({props:{command:{type:String,required:!0},title:{type:String,required:!0},icon:{type:Object,required:!1,default:void 0}},setup(){let{viewModel:e}=Je();return{viewModel:e}}}),Dh=["disabled","title"];function Ih(e,t,n,o,s,r){return D(),R("button",{class:"baklava-toolbar-entry baklava-toolbar-button",disabled:!e.viewModel.commandHandler.canExecuteCommand(e.command),title:e.title,onClick:t[0]||(t[0]=i=>e.viewModel.commandHandler.executeCommand(e.command))},[e.icon?(D(),Ie(zo(e.icon),{key:0})):(D(),R(ne,{key:1},[gr(ye(e.title),1)],64))],8,Dh)}var Sh=ae(Th,[["render",Ih]]),Vh=de({components:{ToolbarButton:Sh},setup(){let{viewModel:e}=Je();return{isSubgraph:z(()=>e.value.displayedGraph!==e.value.editor.graph),commands:[{command:us,title:"Copy",icon:fh},{command:ds,title:"Paste",icon:sh},{command:ls,title:"Undo",icon:Mp},{command:cs,title:"Redo",icon:Lp},{command:Gr,title:"Create Subgraph",icon:kh}],subgraphCommands:[{command:Tn,title:"Save Subgraph",icon:Eh},{command:Yr,title:"Back to Main Graph",icon:Xp}]}}}),$h={class:"baklava-toolbar"};function Mh(e,t,n,o,s,r){let i=ot("toolbar-button");return D(),R("div",$h,[(D(!0),R(ne,null,Ye(e.commands,a=>(D(),Ie(i,{key:a.command,command:a.command,title:a.title,icon:a.icon},null,8,["command","title","icon"]))),128)),e.isSubgraph?(D(!0),R(ne,{key:0},Ye(e.subgraphCommands,a=>(D(),Ie(i,{key:a.command,command:a.command,title:a.title,icon:a.icon},null,8,["command","title","icon"]))),128)):st("",!0)])}var Ph=ae(Vh,[["render",Mh]]),Ah=["onPointermove"],Rh={class:"connections-container"},Zr=de({__name:"Editor",props:{viewModel:{}},setup(e){let t=e,n=Symbol("EditorToken"),o=yt(t,"viewModel");sl(o);let s=H(null);Jo("editorEl",s);let r=z(()=>t.viewModel.displayedGraph.nodes),i=z(()=>t.viewModel.displayedGraph.connections),a=z(()=>t.viewModel.displayedGraph.selectedNodes),c=pd(),l=hd(),u=z(()=>({...c.styles.value})),d=H(0);t.viewModel.editor.hooks.load.subscribe(n,b=>(d.value++,b));let p=b=>{c.onPointerMove(b),l.onMouseMove(b)},m=b=>{b.button===0&&(b.target===s.value&&(V(),c.onPointerDown(b)),l.onMouseDown())},v=b=>{c.onPointerUp(b),l.onMouseUp()},y=b=>{b.key==="Tab"&&b.preventDefault(),t.viewModel.commandHandler.handleKeyDown(b)},k=b=>{t.viewModel.commandHandler.handleKeyUp(b)},P=b=>{t.viewModel.commandHandler.pressedKeys.includes("Control")||V(),t.viewModel.displayedGraph.selectedNodes.push(b)},V=()=>{t.viewModel.displayedGraph.selectedNodes=[]};return(b,B)=>(D(),R("div",{ref_key:"el",ref:s,tabindex:"-1",class:ge(["baklava-editor",{"baklava-ignore-mouse":!!je(l).temporaryConnection.value||je(c).dragging.value,"--temporary-connection":!!je(l).temporaryConnection.value}]),onPointermove:Ke(p,["self"]),onPointerdown:m,onPointerup:v,onWheel:B[0]||(B[0]=Ke((...N)=>je(c).onMouseWheel&&je(c).onMouseWheel(...N),["self"])),onKeydown:y,onKeyup:k},[Be(b.$slots,"background",{},()=>[X(gd)]),Be(b.$slots,"toolbar",{},()=>[X(Ph)]),Be(b.$slots,"palette",{},()=>[X(Nl)]),(D(),R("svg",Rh,[(D(!0),R(ne,null,Ye(i.value,N=>(D(),R("g",{key:N.id+d.value.toString()},[Be(b.$slots,"connection",{connection:N},()=>[X(dl,{connection:N},null,8,["connection"])])]))),128)),Be(b.$slots,"temporaryConnection",{temporaryConnection:je(l).temporaryConnection.value},()=>[je(l).temporaryConnection.value?(D(),Ie(fl,{key:0,connection:je(l).temporaryConnection.value},null,8,["connection"])):st("",!0)])])),M("div",{class:"node-container",style:Re(u.value)},[X(Za,{name:"fade"},{default:En(()=>[(D(!0),R(ne,null,Ye(r.value,N=>Be(b.$slots,"node",{key:N.id+d.value.toString(),node:N,selected:a.value.includes(N),onSelect:J=>P(N)},()=>[X(ul,{node:N,selected:a.value.includes(N),onSelect:J=>P(N)},null,8,["node","selected","onSelect"])])),128))]),_:3})],4),Be(b.$slots,"sidebar",{},()=>[X(pl)]),Be(b.$slots,"minimap",{},()=>[b.viewModel.settings.enableMinimap?(D(),Ie(hl,{key:0})):st("",!0)])],42,Ah))}});function Fh(e){let t=H([]),n=H([]);return{pressedKeys:t,handleKeyDown:i=>{t.value.includes(i.key)||t.value.push(i.key),n.value.forEach(a=>{a.keys.every(c=>t.value.includes(c))&&e(a.commandName)})},handleKeyUp:i=>{let a=t.value.indexOf(i.key);a>=0&&t.value.splice(a,1)},registerHotkey:(i,a)=>{n.value.push({keys:i,commandName:a})}}}var xl=()=>{let e=H(new Map),t=(r,i)=>{if(e.value.has(r))throw new Error(`Command "${r}" already exists`);e.value.set(r,i)},n=(r,i=!1,...a)=>{if(!e.value.has(r)){if(i)throw new Error(`[CommandHandler] Command ${r} not registered`);return}return e.value.get(r).execute(...a)},o=(r,i=!1,...a)=>{if(!e.value.has(r)){if(i)throw new Error(`[CommandHandler] Command ${r} not registered`);return!1}return e.value.get(r).canExecute(a)},s=Fh(n);return Me({registerCommand:t,executeCommand:n,canExecuteCommand:o,...s})},Uh=e=>!(e instanceof qe);function jh(e,t){return{switchGraph:o=>{let s;if(Uh(o)){s=new qe(e.value),o.createGraph(s);let r=s.nodes.reduce((c,l)=>{let u=l.position.x;return u<c?u:c},1/0),i=s.nodes.reduce((c,l)=>{let u=l.position.y;return u<c?u:c},1/0),a=s.nodes.reduce((c,l)=>{let u=l.position.x+l.width;return u>c?u:c},-1/0);s.inputs.forEach((c,l)=>{let u=s.nodes.find(p=>p instanceof co&&p.graphInterfaceId===c.id);u||(u=new co,u.inputs.name.value=c.name,u.graphInterfaceId=c.id,u.position={x:r-300,y:i+l*200},s.addNode(u));let d=s.findNodeInterface(c.nodeInterfaceId);if(!d){console.warn(`Could not find target interface ${c.nodeInterfaceId} for subgraph input node`);return}s.addConnection(u.outputs.placeholder,d)}),s.outputs.forEach((c,l)=>{let u=s.nodes.find(p=>p instanceof uo&&p.graphInterfaceId===c.id);u||(u=new uo,u.inputs.name.value=c.name,u.graphInterfaceId=c.id,u.position={x:a+100,y:i+l*200},s.addNode(u));let d=s.findNodeInterface(c.nodeInterfaceId);if(!d){console.warn(`Could not find target interface ${c.nodeInterfaceId} for subgraph input node`);return}s.addConnection(d,u.inputs.placeholder)})}else{if(o!==e.value.graph)throw new Error("Can only switch using 'Graph' instance when it is the root graph. Otherwise a 'GraphTemplate' must be used.");s=o}t.value&&t.value!==e.value.graph&&t.value.destroy(),s.panning=s.panning??o.panning??{x:0,y:0},s.scaling=s.scaling??o.scaling??1,s.selectedNodes=s.selectedNodes??[],s.sidebar=s.sidebar??{visible:!1,nodeId:"",optionName:""},t.value=s}}}function Lh(e){e.position=e.position??{x:0,y:0},e.disablePointerEvents=!1,e.twoColumn=e.twoColumn??!1,e.width=e.width??200}function Qr(e){let t=H(e??new Mn),n=Symbol("ViewModelToken"),o=H(null),s=zs(o),{switchGraph:r}=jh(t,o),i=z(()=>s.value&&s.value!==t.value.graph),a=Me({useStraightConnections:!1,enableMinimap:!1,background:{gridSize:100,gridDivision:5,subGridVisibleThreshold:.6},sidebar:{width:300,resizable:!0}}),c=xl(),l=Np(s,c),u=Op(s,t,c),d={renderNode:new me(null),renderInterface:new me(null)};return wp(s,c,r),xp(s,c),ft(t,(p,m)=>{m&&(m.events.registerGraph.unsubscribe(n),m.graphEvents.beforeAddNode.unsubscribe(n),p.nodeHooks.beforeLoad.unsubscribe(n),p.nodeHooks.afterSave.unsubscribe(n),p.graphTemplateHooks.beforeLoad.unsubscribe(n),p.graphTemplateHooks.afterSave.unsubscribe(n),p.graph.hooks.load.unsubscribe(n),p.graph.hooks.save.unsubscribe(n)),p&&(p.nodeHooks.beforeLoad.subscribe(n,(v,y)=>(y.position=v.position??{x:0,y:0},y.width=v.width??200,y.twoColumn=v.twoColumn??!1,v)),p.nodeHooks.afterSave.subscribe(n,(v,y)=>(v.position=y.position,v.width=y.width,v.twoColumn=y.twoColumn,v)),p.graphTemplateHooks.beforeLoad.subscribe(n,(v,y)=>(y.panning=v.panning,y.scaling=v.scaling,v)),p.graphTemplateHooks.afterSave.subscribe(n,(v,y)=>(v.panning=y.panning,v.scaling=y.scaling,v)),p.graph.hooks.load.subscribe(n,(v,y)=>(y.panning=v.panning,y.scaling=v.scaling,v)),p.graph.hooks.save.subscribe(n,(v,y)=>(v.panning=y.panning,v.scaling=y.scaling,v)),p.graphEvents.beforeAddNode.subscribe(n,v=>Lh(v)),t.value.registerNodeType(co,{category:"Subgraphs"}),t.value.registerNodeType(uo,{category:"Subgraphs"}),r(p.graph))},{immediate:!0}),Me({editor:t,displayedGraph:s,isSubgraph:i,settings:a,commandHandler:c,history:l,clipboard:u,hooks:d,switchGraph:r})}var Hh=Object.freeze(Object.defineProperty({__proto__:null,Connection:Wr,ConnectionWrapper:dl,ContextMenu:Kr,Minimap:hl,Node:ul,NodeInterface:Sr,NodePalette:Nl,Sidebar:pl,TemporaryConnection:fl},Symbol.toStringTag,{value:"Module"}));function Bh(e){let t;return Qa({setup(){let n=Qr();return t=n,{viewModel:n}},render(){return es(Zr,{viewModel:this.viewModel})}}).mount(e),t}return $l(Kh);})();
/*! Bundled license information:

@vue/runtime-core/dist/runtime-core.esm-bundler.js:
  (*! #__NO_SIDE_EFFECTS__ *)

@vue/runtime-dom/dist/runtime-dom.esm-bundler.js:
  (*! #__NO_SIDE_EFFECTS__ *)

@vue/runtime-dom/dist/runtime-dom.esm-bundler.js:
  (*! #__NO_SIDE_EFFECTS__ *)
*/
//# sourceMappingURL=bundle.js.map
